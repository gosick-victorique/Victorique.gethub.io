<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>codeforces-选做 | shallwe|code</title>
  <meta name="author" content="shallwe">
  
  <meta name="description" content="OI-blog">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="codeforces-选做"/>
  <meta property="og:site_name" content="shallwe|code"/>

  
    <meta property="og:image" content="undefined"/>
  

  
    <link rel="alternative" href="/atom.xml" title="shallwe|code" type="application/atom+xml">
  
  
    <link href="/favicon.ico" rel="icon">
  

  <!-- CSS -->
  <link rel="stylesheet" href="/css/themes/bootstrap.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML'></script>
  <!-- analytics -->
  
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-97384825-1', 'auto');
  ga('send', 'pageview');
</script>



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?26e751f78e8841e981f7e01910d5fbf6";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>


</head>

 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
	<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
       <a class="navbar-brand" href="/">shallwe|code</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" title="All the articles.">
			  <i class="fa fa-archive"></i>归档页
			</a>
		  </li>
		  
		  <li>
			<a href="/categories" title="All the categories.">
			  <i class="fa fa-folder"></i>分类页
			</a>
		  </li>
		  
		  <li>
			<a href="/tags" title="All the tags.">
			  <i class="fa fa-tags"></i>标签页
			</a>
		  </li>
		  
		  <li>
			<a href="/friend" title="All the friends.">
			  <i class="fa fa-link"></i>小伙伴
			</a>
		  </li>
		  
		  <li>
			<a href="/about" title="About me.">
			  <i class="fa fa-user"></i>博主是个蒟蒻
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 


	
		<div class="page-header page-header-inverse ">		
			<h1 class="title title-inverse "> codeforces-选做</h1>
		</div>		
	






<div class="row post">
	<!-- cols -->
	
	<div id="top_meta"></div>
	<div class="col-md-9">
	

	<!-- content -->
	<div class="mypage">		
	  		

	  <blockquote>
<p>选做一些codeforces 上的<del>无脑码农题</del>。</p>
</blockquote>
<a id="more"></a>
<h1 id="cf-739calyona-and-towers">【CF 739C】Alyona and towers</h1>
<h2 id="题目链接"><a href="http://codeforces.com/contest/739/problem/C" target="_blank" rel="external">题目链接</a></h2>
<h2 id="题目大意">题目大意</h2>
<p>两个操作： 1. 区间加法； 2. 查询最长上凸单峰子串长；</p>
<h2 id="解题报告">解题报告</h2>
<p><span class="math display">\[a_l &lt; a_{l + 1} &lt; a_{l + 2} &lt; ... &lt; a_k &gt; a_{k + 1} &gt; a_{k + 2} &gt; ... &gt; a_r\]</span></p>
<p>差分之后， 这个式子等价于一串连续的正数拼一串连续的负数；</p>
<p>可以直接用<strong>线段树</strong>维护三个信息： 左侧开始最长合法串， 右侧开始最长合法串， 不限制位置的最长合法串；</p>
<p>合并的时候讨论节点处两点的正负；</p>
<p>区间加，差分后变成单点加；</p>
<h2 id="代码">代码</h2>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt; </span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>; </div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> foru(i, s, t) for (i = (int)s; i &lt;= (int) t; ++i)   </span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ford(i, s, t) for (i = (int)s; i ^ (int) t; --i) </span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> F first</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> S second</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> check cout &lt;&lt; 1 &lt;&lt; endl</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> dou (<span class="meta-string">", "</span>) </span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mao (<span class="meta-string">": "</span>)</span></div><div class="line"><span class="keyword">typedef</span> pair &lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; pii; </div><div class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; vi; </div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll; </div><div class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> ff; </div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">310000</span>; </div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> inf = <span class="number">1000000000</span>; </div><div class="line"><span class="keyword">int</span> lan[N &lt;&lt; <span class="number">2</span>], ran[N &lt;&lt; <span class="number">2</span>], ans[N &lt;&lt; <span class="number">2</span>], n, m; ll a[N];</div><div class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; </div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">in</span><span class="params">(T &amp;x )</span> </span>&#123; </div><div class="line">    <span class="keyword">char</span> ch = getchar(); <span class="keyword">int</span> f= <span class="number">1</span>; </div><div class="line">    <span class="keyword">for</span> (; ch &lt; <span class="string">'0'</span> || ch &gt; <span class="string">'9'</span>; ch = getchar())    </div><div class="line">        <span class="keyword">if</span> ( ch == <span class="string">'-'</span>) f =  <span class="number">-1</span>; </div><div class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; ch &gt;= <span class="string">'0'</span>  &amp;&amp; ch &lt;= <span class="string">'9'</span>; ch = getchar()) </div><div class="line">        x = x * <span class="number">10</span> + ch - <span class="number">48</span>; </div><div class="line">    x *= f; </div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">newnode</span><span class="params">(<span class="keyword">int</span> x, ll va)</span> </span>&#123;</div><div class="line">    lan[x] = ran[x] = ans[x] = (va != <span class="number">0</span>); </div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">push_up</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123; </div><div class="line">    <span class="keyword">int</span> mid = l + r &gt;&gt; <span class="number">1</span>; </div><div class="line">    ans[x] = max(ans[x &lt;&lt; <span class="number">1</span>], ans[x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>]); </div><div class="line">    lan[x] = lan[x &lt;&lt; <span class="number">1</span>] , ran[x] = ran[x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>]; </div><div class="line">    <span class="keyword">if</span> (!(a[mid] &lt; <span class="number">0</span> &amp;&amp; a[mid + <span class="number">1</span>] &gt; <span class="number">0</span>) &amp;&amp; a[mid] &amp;&amp; a[mid + <span class="number">1</span>])  &#123;</div><div class="line">        ans[x] = max(ans[x], ran[x &lt;&lt; <span class="number">1</span>] + lan[x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>]);     </div><div class="line">        <span class="keyword">if</span> (lan[x] == (mid - l + <span class="number">1</span>) )  lan[x] += lan[x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>]; </div><div class="line">        <span class="keyword">if</span> (ran[x] == (r - mid)) ran[x] += ran[x &lt;&lt; <span class="number">1</span>]; </div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123; </div><div class="line">    <span class="keyword">if</span> (l &gt; r) <span class="keyword">return</span>; </div><div class="line">    <span class="keyword">if</span> (l == r) newnode(x, a[l]); </div><div class="line">    <span class="keyword">else</span> &#123; </div><div class="line">        <span class="keyword">int</span> mid = l + r &gt;&gt; <span class="number">1</span>;</div><div class="line">        build(x &lt;&lt; <span class="number">1</span>, l, mid); </div><div class="line">        build(x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r) ; </div><div class="line">        push_up(x, l, r); </div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> go, <span class="keyword">int</span> delta)</span> </span>&#123;  </div><div class="line">    <span class="keyword">if</span> (l &gt; r) <span class="keyword">return</span>; </div><div class="line">    <span class="keyword">if</span> (l == r) a[l] += delta, newnode(x, a[l]); </div><div class="line">    <span class="keyword">else</span> &#123; </div><div class="line">        <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>; </div><div class="line">        <span class="keyword">if</span> (go &lt;= mid) add(x &lt;&lt; <span class="number">1</span>, l, mid, go, delta); </div><div class="line">        <span class="keyword">if</span> (go &gt; mid)  add(x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, go, delta); </div><div class="line">        push_up(x, l, r); </div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    in(n); <span class="keyword">int</span> i, j, x, y, d; </div><div class="line">    foru(i, <span class="number">1</span>, n) in(a[i]);    </div><div class="line">    foru(i, <span class="number">1</span>, n) a[i] = a[i+<span class="number">1</span>] - a[i]; </div><div class="line">    --n, build(<span class="number">1</span>, <span class="number">1</span>, n), in(m);</div><div class="line">    foru(i, <span class="number">1</span>, m) &#123; </div><div class="line">        in(x), in(y), in(d); </div><div class="line">        <span class="keyword">if</span> (x &gt; <span class="number">1</span>) add(<span class="number">1</span>, <span class="number">1</span>, n, x<span class="number">-1</span>, d);</div><div class="line">        <span class="keyword">if</span> (y &lt;= n) add(<span class="number">1</span>, <span class="number">1</span>, n, y, -d);   </div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans[<span class="number">1</span>] + <span class="number">1</span>); </div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>; </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="cf-739egosha-is-hunting">【CF 739E】Gosha is hunting</h1>
<h2 id="题目链接-1"><a href="http://codeforces.com/contest/739/problem/E" target="_blank" rel="external">题目链接</a></h2>
<h2 id="题目大意-1">题目大意</h2>
<p><span class="math inline">\(n\)</span>个小精灵，<span class="math inline">\(a\)</span>个宝贝球，<span class="math inline">\(b\)</span>的大师球，每个小精灵可以用宝贝球或大师球或两个球捕捉，成功概率为<span class="math inline">\(p_i\)</span>,<span class="math inline">\(u_i\)</span>,<span class="math inline">\(p_i + u_i - p_i * u_i\)</span> 求期望最大捕捉数; （摘自<a href="http://kzoacn.xyz/index.php/archives/238" target="_blank" rel="external">zky学长的blog</a>)</p>
<h2 id="解题报告-1">解题报告</h2>
<p>首先可以写一个<span class="math inline">\(O(n^3)\)</span>的DP, 令<span class="math inline">\(f[n][a][b]\)</span>表示前<span class="math inline">\(n\)</span>个小精灵，用了<span class="math inline">\(a\)</span>个宝贝球，<span class="math inline">\(b\)</span>个大师球， 期望最大的捕捉数， 容易得到： <span class="math display">\[f[n][a][b]=max \{ f[n-1][a-1][b]+p_n, f[n-1][a][b-1]+u_n,f[n-1][a-1][b-1]+p_n+u_n-p_n*u_n \}\]</span></p>
<p>这个DP是可以AC的。。。</p>
<p>从zky学长那里学了一个很优秀的做法，和去年IOI的最后一题做法相似：</p>
<p>对于一个可以求最值的凸函数<span class="math inline">\(f(x)\)</span>, 构造<span class="math inline">\(F(x)=f(x)-kx\)</span>, 那么<span class="math inline">\(F(x)\)</span>为凸函数且可 求最值， 通过二分<span class="math inline">\(k\)</span>使得<span class="math inline">\(F(x)\)</span>的最值点左右平移， 当最值点位于<span class="math inline">\(x\)</span>， 可以得到<span class="math inline">\(f(x)=F(x)+kx\)</span>, 从而实现求<span class="math inline">\(f(x)\)</span>每个自变量对应的函数值。</p>
<p>对于这个题， 因为某些不可说的原因，<span class="math inline">\(f[i][j](k)\)</span>是一个凸函数， 利用上述方法可以通过<span class="math inline">\(O(\log^{-1}eps \times n^2)\)</span>得到答案。</p>
<h2 id="代码-1">代码</h2>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt; </span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>; </div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> foru(i, s, t) for (i = (int)s; i &lt;= (int) t; ++i)   </span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ford(i, s, t) for (i = (int)s; i ^ (int) t; --i) </span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> F first</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> S second</span></div><div class="line"><span class="keyword">typedef</span> pair &lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; pii; </div><div class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; vi; </div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll; </div><div class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> ff; </div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2010</span>; </div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> inf = <span class="number">1000000000</span>; </div><div class="line"><span class="keyword">const</span> ff eps = <span class="number">1e-9</span>;</div><div class="line"><span class="keyword">int</span> n, a, b; </div><div class="line">ff p[N], u[N], mix[N], f[N][N], cnt[N][N]; </div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;n, &amp;a, &amp;b); <span class="keyword">int</span> i, j; </div><div class="line">    foru(i, <span class="number">1</span>, n) <span class="built_in">scanf</span>(<span class="string">"%lf"</span>, &amp;p[i]); </div><div class="line">    foru(i, <span class="number">1</span>, n) <span class="built_in">scanf</span>(<span class="string">"%lf"</span>, &amp;u[i]), </div><div class="line">    mix[i] = p[i] + u[i] - p[i] * u[i]; </div><div class="line">    ff l = <span class="number">-1e3</span>, r = <span class="number">1e3</span>, k; </div><div class="line">    <span class="keyword">while</span> (l + eps &lt; r) &#123;</div><div class="line">        k = (l + r) * <span class="number">0.5</span>; </div><div class="line">        foru(i, <span class="number">0</span>, n) foru(j, <span class="number">0</span>, i) </div><div class="line">            f[i][j] = <span class="number">-1e10</span>, cnt[i][j] = <span class="number">0</span>;     </div><div class="line">        f[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span>; </div><div class="line">        foru(i, <span class="number">1</span>, n) foru(j, <span class="number">0</span>, i) &#123;</div><div class="line">            <span class="keyword">if</span> (j &lt; i &amp;&amp; f[i<span class="number">-1</span>][j] &gt; f[i][j]) f[i][j] = f[i<span class="number">-1</span>][j], cnt[i][j] = cnt[i<span class="number">-1</span>][j]; </div><div class="line">            <span class="keyword">if</span> (j &amp;&amp; f[i<span class="number">-1</span>][j<span class="number">-1</span>] + p[i] &gt; f[i][j]) f[i][j] = f[i<span class="number">-1</span>][j<span class="number">-1</span>] + p[i], cnt[i][j] = cnt[i<span class="number">-1</span>][j<span class="number">-1</span>]; </div><div class="line">            <span class="keyword">if</span> (j &lt; i &amp;&amp; f[i<span class="number">-1</span>][j] + u[i] + k&gt; f[i][j]) f[i][j] = f[i<span class="number">-1</span>][j] + u[i] + k, cnt[i][j] = cnt[i<span class="number">-1</span>][j] + <span class="number">1</span>; </div><div class="line">            <span class="keyword">if</span> (j &amp;&amp; f[i<span class="number">-1</span>][j<span class="number">-1</span>] + mix[i] + k&gt; f[i][j]) f[i][j] = f[i<span class="number">-1</span>][j<span class="number">-1</span>] + mix[i] + k, cnt[i][j] = cnt[i<span class="number">-1</span>][j<span class="number">-1</span>] + <span class="number">1</span>; </div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (cnt[n][a] &lt; b) l = k; <span class="keyword">else</span> r = k; </div><div class="line">    &#125;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%.10lf\n"</span>, f[n][a] - (l + r) * <span class="number">0.5</span> * b); </div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>; </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="cf-736dpermutations">【CF 736D】Permutations</h1>
<h2 id="题目链接-2"><a href="http://codeforces.com/contest/736/problem/D" target="_blank" rel="external">题目链接</a></h2>
<h2 id="题目大意-2">题目大意</h2>
<p>要得到一个长度为<span class="math inline">\(n\)</span>的排列，给出<span class="math inline">\(m\)</span>个信息<span class="math inline">\((x,y)\)</span>，表示<span class="math inline">\(x\)</span>可以放置在<span class="math inline">\(y\)</span>这个位置，保证使用这<span class="math inline">\(m\)</span>个信息，方案数为奇数， 要得到对每个信息而言，如果不使用，方案数是奇数还是偶数； ## 解题报告</p>
<div class="figure">
<img src="/cf/1.jpg" alt="评论">
<p class="caption">评论</p>
</div>
<p>首先求二分图的完美匹配数， 实际上是联通矩阵的积和式的值， 在<span class="math inline">\(\pmod 2\)</span>的意义下， 与行列式等价。</p>
<p>所以问题等价于求一个行列式去掉<span class="math inline">\((i,j)\)</span>处的<span class="math inline">\(1\)</span>，剩下的行列式的值。</p>
<p>考虑将行列式沿第<span class="math inline">\(i\)</span>行展开，那么删掉<span class="math inline">\(1\)</span>造成的影响就是<span class="math inline">\(j\)</span>位置的代数余子式的值， 而又有伴随矩阵<span class="math inline">\(adj(A)=C^{T}(A)\)</span>, 其中<span class="math inline">\(C(A)\)</span>代数余子矩阵， 且<span class="math inline">\(adj(A)\)</span>可以通过<span class="math inline">\(adj(A)=A^{-1}*det(A)\)</span>快速求解， 所以利用bitset压位， 预处理复杂度是<span class="math inline">\(O(n^2\log n)\)</span>的。</p>
<h2 id="代码-2">代码</h2>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt; </span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>; </div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FOR(i, a, b) for (int i = (a), _b = (b); i &lt;= b; ++i) </span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FORD(i, a, b) for (int i = (a), _b = (b); i &gt;= b; --i) </span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> REP(i, b) for (int i = 0, _b = (b); i &lt; b; ++i) </span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> SZ(x) ((int)(x).size())</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; vii; </div><div class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; pii; </div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll; </div><div class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> ff; </div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2010</span>; </div><div class="line"></div><div class="line"><span class="keyword">int</span> n, m, l[N * N], r[N * N]; </div><div class="line"><span class="built_in">bitset</span>&lt;N &lt;&lt; 1&gt; a[N]; </div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123; </div><div class="line">	ios :: sync_with_stdio(<span class="literal">false</span>); </div><div class="line">	<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m; <span class="keyword">int</span> x, y; </div><div class="line">	FOR(i, <span class="number">1</span>, m) &#123;</div><div class="line">		<span class="built_in">cin</span> &gt;&gt; x &gt;&gt; y; </div><div class="line">		a[x].<span class="built_in">set</span>(y), l[i] = x, r[i] = y; </div><div class="line">	&#125;</div><div class="line">	FOR(i, <span class="number">1</span>, n) a[i].<span class="built_in">set</span>(i + n); </div><div class="line">	FOR(i, <span class="number">1</span>, n) &#123; </div><div class="line">		<span class="keyword">int</span> j = i; </div><div class="line">		<span class="keyword">while</span> (!a[j].test(i)) ++j; </div><div class="line">		swap(a[i], a[j]); </div><div class="line">		FOR(k, <span class="number">1</span>, n) <span class="keyword">if</span> ( k != i &amp;&amp; a[k].test(i)) </div><div class="line">			a[k] ^= a[i]; </div><div class="line">	&#125;</div><div class="line">	FOR(i, <span class="number">1</span>, m)</div><div class="line">		<span class="built_in">puts</span>(a[ r[i] ].test(n + l[i]) ? <span class="string">"NO"</span> : <span class="string">"YES"</span>); </div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>; </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="cf-741carpas-overnight-party-and-mehrdads-silent-entering">【CF 741C】Arpa’s overnight party and Mehrdad’s silent entering</h1>
<h2 id="题目链接-3"><a href="http://codeforces.com/contest/741/problem/C" target="_blank" rel="external">题目链接</a></h2>
<h2 id="题目大意-3">题目大意</h2>
<p>每相邻的三个位置不能拥有相同类型的食物, 情侣不能拥有相同类型的食物;</p>
<p>构造一个合法的食物分配方法或者输出无解; ## 解题报告 显然, 如果没有相邻三个的限制, 这个题一定有解;</p>
<p>如果让第<span class="math inline">\(k* 2\)</span>和第<span class="math inline">\(k* 2+1\)</span>个类型不同, 那么相邻的三个就一定不全相同, 根据二分图染色的性质, 结合图的特殊性, 可以得到, 这个图不存在奇环, 所以一定可以构造出二分图;</p>
<p>那么就可以直接二分图染色;</p>
<h2 id="代码-3">代码</h2>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FORU(i, a, b) for (int i = a, nn = int(b); i &lt;= nn; ++i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FORD(i, a, b) for (int i = a, nn = int(b); i &gt;= nn; --i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> REP(i, b) for (int i = a, nn = int(b); i &lt;= nn; ++i)</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; pii;</div><div class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; vi; </div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">200100</span>;</div><div class="line"></div><div class="line">vi nxt[N];</div><div class="line"><span class="built_in">vector</span>&lt; pii &gt; par;</div><div class="line"><span class="keyword">int</span> n, ans[N];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> a)</span> </span>&#123;</div><div class="line">	ans[x] = a;</div><div class="line">	FORU(i, <span class="number">0</span>, sz(nxt[x])<span class="number">-1</span>)</div><div class="line">		<span class="keyword">if</span> (ans[nxt[x][i]] == <span class="number">-1</span>)</div><div class="line">			dfs(nxt[x][i], a ^ <span class="number">1</span>) ;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line"> 	ios :: sync_with_stdio(<span class="literal">false</span>);</div><div class="line">	<span class="keyword">int</span> x, y;</div><div class="line">	<span class="built_in">cin</span> &gt;&gt; n;</div><div class="line">	FORU(i, <span class="number">1</span>, n) &#123;</div><div class="line"> 		<span class="built_in">cin</span> &gt;&gt; x &gt;&gt; y;</div><div class="line">		nxt[x].pb(y), nxt[y].pb(x);</div><div class="line">		par.pb( mp(x, y) );</div><div class="line">	&#125;</div><div class="line">	FORU(i, <span class="number">1</span>, n) &#123;</div><div class="line">		nxt[i * <span class="number">2</span> - <span class="number">1</span>].pb(i * <span class="number">2</span>);</div><div class="line">		nxt[i * <span class="number">2</span>].pb(i * <span class="number">2</span> - <span class="number">1</span>);</div><div class="line">	&#125;</div><div class="line">	mmst(ans, <span class="number">-1</span>);</div><div class="line">	FORU(i, <span class="number">1</span>, n*<span class="number">2</span>)</div><div class="line">		<span class="keyword">if</span> (ans[i] == <span class="number">-1</span>)</div><div class="line">			dfs(i, <span class="number">0</span>);</div><div class="line">	FORU(i, <span class="number">0</span>, sz(par) - <span class="number">1</span>)</div><div class="line">		<span class="built_in">cout</span> &lt;&lt; ans[par[i].fi] + <span class="number">1</span> &lt;&lt; <span class="string">' '</span> &lt;&lt; ans[par[i].se] + <span class="number">1</span> &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="cf-741darpas-letter-marked-tree-and-mehrdads-dokhtar-kosh-paths">【CF 741D】Arpa’s letter-marked tree and Mehrdad’s Dokhtar-kosh paths</h1>
<h2 id="题目大意-4">题目大意</h2>
<p>一棵树, 每个节点有一个字符, 求出每个点的子树中, 最长的可以通过改变顺序构成回文串的链; ## 解题报告 翻译一下, 将每个字符当做一个二进制位上的一, 对链的要求实际上等价于异或和为0(长度为偶的回文串), 或者异或和的某个数位为1(长度为奇的回文串);<br> 一个链 <span class="math inline">\((u,v)\)</span> , 异或和为<span class="math inline">\(v[u] \ xor \ v[v] \ xor \ a[lca]\)</span>, 其中<span class="math inline">\(v[x]\)</span> 表示节点<span class="math inline">\(x\)</span>到根节点的异或和, <span class="math inline">\(a[x]\)</span> 表示 <span class="math inline">\(x\)</span> 节点自己的二进制数值;<br> 所以可以用一个数组将每个二进制数所表示的 <span class="math inline">\(v[x]\)</span> 对应的深度最大的 <span class="math inline">\(x\)</span> 的深度记录下来, 在 <span class="math inline">\(lca\)</span> 处通过枚举为一的数位, 用 <span class="math inline">\(O(logn)\)</span> 查询答案;<br> 关键是, 怎么用数组记录子树中的信息?<br> 显然需要使用树上的启发式合并, 具体一点, 就是“dsu on the tree”, 简单一点, 就是树链剖分;<br> 这个可以看 <a href="http://blog.csdn.net/qaq__qaq/article/details/53455462" target="_blank" rel="external">yveh的一个学习笔记</a><br> 代码很好写, 可以算是裸题;<br></p>
<h2 id="代码-4">代码</h2>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FORU(i, a, b) for (int i = a, nn = int(b); i &lt;= nn; ++i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FORD(i, a, b) for (int i = a, nn = int(b); i &gt;= nn; --i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> REP(i, b) for (int i = a, nn = int(b); i &lt;= nn; ++i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> sz(x) (int)(x).size()</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mmst(a, x) memset(a, x, sizeof(a))</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; vi;</div><div class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; pii;</div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">500010</span>;</div><div class="line"></div><div class="line"><span class="keyword">int</span> n, toTwo[<span class="number">200</span>], sons[N], in[N], out[N], id[N];</div><div class="line"><span class="keyword">int</span> heav[N], bag[<span class="number">1</span> &lt;&lt; <span class="number">23</span>], cnt = <span class="number">0</span>, pref[N], dep[N], ans[N];</div><div class="line">vi to[N], alpha[N], tmp;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">up</span><span class="params">(<span class="keyword">int</span> &amp;ans, <span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">	<span class="keyword">if</span> (x &gt; ans ) ans = x;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">	sons[x] = <span class="number">1</span>, id[++cnt] = x, in[x] = cnt, heav[x]= <span class="number">0</span>;  </div><div class="line">	FORU(i, <span class="number">0</span>, sz(to[x]) - <span class="number">1</span>) &#123;</div><div class="line">		pref[to[x][i]] = pref[x] ^ alpha[x][i];</div><div class="line">		dep[to[x][i]] = dep[x] + <span class="number">1</span>, dfs(to[x][i]);</div><div class="line">		<span class="keyword">if</span> (sons[ to[x][i] ] &gt; sons[ heav[x] ])</div><div class="line">			heav[x] = to[x][i];</div><div class="line">		sons[x] += sons[ to[x][i] ];</div><div class="line">	&#125;</div><div class="line">	out[x] = cnt;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">got_ans</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> type)</span> </span>&#123;</div><div class="line"><span class="comment">// type: 1-clear, 0-not</span></div><div class="line"><span class="comment">//  tmp: a stack recording vertices in the heavy subtrees;</span></div><div class="line">	ans[x] = <span class="number">0</span>;</div><div class="line">	FORU(i, <span class="number">0</span>, sz(to[x]) - <span class="number">1</span>) 	</div><div class="line">		<span class="keyword">if</span> (to[x][i] != heav[x])</div><div class="line">			got_ans(to[x][i], <span class="number">1</span>), up(ans[x], ans[to[x][i]]);</div><div class="line">	<span class="keyword">if</span> (heav[x]) 	</div><div class="line">		got_ans(heav[x], <span class="number">0</span>), up(ans[x], ans[ heav[x] ]);</div><div class="line"><span class="comment">//  information of subtrees updates ans of x;</span></div><div class="line">	<span class="keyword">int</span> y, z;</div><div class="line">	FORU(i, <span class="number">0</span>, sz(to[x]) - <span class="number">1</span>)</div><div class="line">		<span class="keyword">if</span> (to[x][i] != heav[x]) &#123;</div><div class="line">			y = to[x][i]; vi _tmp;</div><div class="line">			FORU(j, in[y], out[y]) &#123;</div><div class="line">				z = id[ j ], tmp.pb(z), _tmp.pb(z);</div><div class="line">				<span class="keyword">if</span> (bag[ pref[z] ] != <span class="number">-1</span>)</div><div class="line">					up(ans[x], bag[ pref[z] ] + dep[z] - dep[x] * <span class="number">2</span>);</div><div class="line">				FORU(k, <span class="string">'a'</span>, <span class="string">'v'</span>)</div><div class="line">					<span class="keyword">if</span> (bag[ pref[z] ^ toTwo[k] ] != <span class="number">-1</span>)</div><div class="line">						up(ans[x], bag[ pref[z] ^ toTwo[k] ] + dep[z] - dep[x] * <span class="number">2</span>); 				</div><div class="line"><span class="comment">//  update ans by forming a line with two</span></div><div class="line">			&#125;</div><div class="line">			FORU(j, <span class="number">0</span>, sz(_tmp) - <span class="number">1</span>) &#123;</div><div class="line">				z = _tmp[j];</div><div class="line">				<span class="keyword">if</span> (dep[z] &gt; bag[ pref[z] ])</div><div class="line">					bag[pref[z]] = dep[z];</div><div class="line"><span class="comment">//  update BAGS</span></div><div class="line">			&#125;				</div><div class="line">		&#125;</div><div class="line">	<span class="keyword">if</span> (bag[ pref[x] ] != <span class="number">-1</span>)</div><div class="line">		up(ans[x], bag[pref[x]] - dep[x]);</div><div class="line">	FORU(k, <span class="string">'a'</span>, <span class="string">'v'</span>)</div><div class="line">		<span class="keyword">if</span> (bag[ pref[x] ^ toTwo[k] ] != <span class="number">-1</span>)</div><div class="line">			up(ans[x], bag[ pref[x] ^ toTwo[k] ] - dep[x]);</div><div class="line">	<span class="keyword">if</span> (dep[x] &gt; bag[ pref[x] ]) bag[pref[x]] = dep[x];</div><div class="line">	tmp.pb(x);</div><div class="line"><span class="comment">// use x to update</span></div><div class="line">	<span class="keyword">if</span> (type == <span class="number">1</span>) &#123;</div><div class="line"> 		FORU(i, <span class="number">0</span>, sz(tmp) - <span class="number">1</span>) &#123;</div><div class="line">			y = tmp[i];</div><div class="line">			<span class="keyword">if</span> (bag[ pref[y] ] != <span class="number">-1</span>)</div><div class="line">				bag[ pref[y] ] = <span class="number">-1</span>;</div><div class="line">		&#125;</div><div class="line">		tmp.clear();</div><div class="line"><span class="comment">// meet the light path and clear</span></div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">	ios :: sync_with_stdio(<span class="literal">false</span>);</div><div class="line">	<span class="built_in">cin</span> &gt;&gt; n; <span class="keyword">int</span> pa; <span class="built_in">string</span> c;</div><div class="line">	FORU(i, <span class="string">'a'</span>, <span class="string">'v'</span>)</div><div class="line">		toTwo[i] = <span class="number">1</span> &lt;&lt; i - <span class="string">'a'</span>;</div><div class="line">	FORU(i, <span class="number">2</span>, n) &#123;</div><div class="line">		<span class="built_in">cin</span> &gt;&gt; pa &gt;&gt; c, to[pa].pb(i);</div><div class="line">		alpha[pa].pb(toTwo[c[<span class="number">0</span>]]);</div><div class="line">	&#125;</div><div class="line">	mmst(bag, <span class="number">-1</span>), dfs(<span class="number">1</span>), got_ans(<span class="number">1</span>, <span class="number">1</span>);</div><div class="line">	FORU(i, <span class="number">1</span>, n)</div><div class="line">		<span class="built_in">cout</span> &lt;&lt; ans[i] &lt;&lt; ((i == n)? <span class="string">'\n'</span> : <span class="string">' '</span>)&lt;&lt; <span class="built_in">endl</span>;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="cf-750enew-year-and-old-subsequence">【CF 750E】New Year and Old Subsequence</h1>
<h2 id="题目链接-4"><a href="%22http://codeforces.com/contest/750/problem/E%22">题目链接</a></h2>
<h2 id="题目大意-5">题目大意</h2>
<p>给出一个字符串, 询问一个区间<span class="math inline">\([l, r]\)</span>中, 使子序列不存在“2016”但存在“2017”, 最少需要删除几个字符; ## 解题报告 这竟然是一道E题, 而且现场只有100个人A; <br> 一个非常有效的性质, 考虑不存在区间查询这种事情, 就求一个给出的字符串, 需要删除几个字符;<br> 那这个是一个很简单的动态规划, 令 <span class="math inline">\(f[i][j]\)</span> 表示到第 <span class="math inline">\(i\)</span> 个字符, 匹配到第 <span class="math inline">\(j\)</span> 个字符, 最少删几个, 转移显然;<br> 发现, 某个位置的字符决定这个位置对转移的影响, 也就是经过一个位置, 存在固定不变的转移;<br> 用一个<span class="math inline">\(5 * 5\)</span>的矩阵可以表示每个位置的转移, 然后查询的时候, 只需要做区间矩阵乘法, 用线段树可以解决; <br> 实际上, 题目中的矩阵可以理解为维护任意两点间的最短路, 即<span class="math inline">\(f[i][j]\)</span>表示匹配<span class="math inline">\(i\)</span>个字符到匹配<span class="math inline">\(j\)</span>个字符, 最少需要删几个字符; <br> 用了刚学习的zkw线段树, 可能哪里写得不好, 跑得竟然很慢, 但确实很短;<br> ## 代码</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FORU(i, a, b) for (int i = a, nn = int(b); i &lt;= nn; ++i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FORD(i, a, b) for (int i = a, nn = int(b); i &gt;= nn; --i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> REP(i, b) for (int i = 0, nn = int(b); i &lt; nn; ++i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> sz(x) (int)(x).size()</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mmst(a, x) memset(a, x, sizeof(a))</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; vi;</div><div class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; pii;</div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">200100</span>; </div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">minify</span><span class="params">(<span class="keyword">int</span> &amp;a, <span class="keyword">int</span> b)</span> </span>&#123; </div><div class="line">    <span class="keyword">if</span> (b &lt; a) a = b; </div><div class="line">&#125; </div><div class="line"></div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">mat</span> &#123;</span> </div><div class="line">    <span class="keyword">int</span> a[<span class="number">5</span>][<span class="number">5</span>]; </div><div class="line">    mat() &#123;mmst(a, <span class="number">127</span>/<span class="number">3</span>);&#125; </div><div class="line">    mat <span class="keyword">operator</span> *(mat b) &#123; </div><div class="line">        mat ans; </div><div class="line">        REP(i, <span class="number">5</span>) REP(j, <span class="number">5</span>) REP(k, <span class="number">5</span>) </div><div class="line">            minify(ans.a[i][k], a[i][j] + b.a[j][k]); </div><div class="line">        <span class="keyword">return</span> ans; </div><div class="line">    &#125; </div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">char</span> x)</span> </span>&#123; </div><div class="line">        REP(i, <span class="number">5</span>) a[i][i] = <span class="number">0</span>; </div><div class="line">        <span class="keyword">if</span> (x == <span class="string">'6'</span>) a[<span class="number">3</span>][<span class="number">3</span>] = a[<span class="number">4</span>][<span class="number">4</span>] = <span class="number">1</span>; </div><div class="line">        <span class="built_in">string</span> s = <span class="string">"2017"</span>; </div><div class="line">        REP(i, <span class="number">4</span>) <span class="keyword">if</span> (x == s[i])</div><div class="line">            a[i][i + <span class="number">1</span>] = <span class="number">0</span>, a[i][i] = <span class="number">1</span>; </div><div class="line">    &#125;</div><div class="line">&#125; ma[N * <span class="number">4</span>];</div><div class="line"><span class="keyword">int</span> n, q, m; </div><div class="line"><span class="built_in">string</span> s;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123; </div><div class="line">    ios :: sync_with_stdio(<span class="literal">false</span>); </div><div class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; q &gt;&gt; s; </div><div class="line">    <span class="keyword">for</span> (m = <span class="number">1</span>; m &lt;= n; m &lt;&lt;= <span class="number">1</span>); </div><div class="line">    FORU(i, <span class="number">1</span>, n) ma[m + i].init(s[i - <span class="number">1</span>]); </div><div class="line">    FORD(i, m<span class="number">-1</span>, <span class="number">1</span>) ma[i] = ma[i &lt;&lt; <span class="number">1</span>] * ma[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>]; </div><div class="line">    REP(i, q) &#123; </div><div class="line">        <span class="keyword">int</span> a, b; </div><div class="line">        <span class="built_in">cin</span> &gt;&gt; a &gt;&gt; b; </div><div class="line">        a += m, b += m; </div><div class="line">        mat lef = ma[a], rig = ma[b]; </div><div class="line">        <span class="keyword">while</span> (a &lt; b - <span class="number">1</span>) &#123; </div><div class="line">            <span class="keyword">if</span> (!(a &amp; <span class="number">1</span>)) lef = lef * ma[a + <span class="number">1</span>]; </div><div class="line">            <span class="keyword">if</span> (b &amp; <span class="number">1</span>) rig = ma[b - <span class="number">1</span>] * rig; </div><div class="line">            a &gt;&gt;= <span class="number">1</span>, b &gt;&gt;= <span class="number">1</span>; </div><div class="line">        &#125; </div><div class="line">        lef = lef * rig; </div><div class="line">        <span class="keyword">if</span> (lef.a[<span class="number">0</span>][<span class="number">4</span>] &gt; N) <span class="built_in">cout</span> &lt;&lt; <span class="number">-1</span> &lt;&lt; <span class="built_in">endl</span>; </div><div class="line">        <span class="keyword">else</span></div><div class="line">            <span class="built_in">cout</span> &lt;&lt; lef.a[<span class="number">0</span>][<span class="number">4</span>] &lt;&lt; <span class="built_in">endl</span>; </div><div class="line">    &#125; </div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>; </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="cf-717fheroes-of-making-magic-iii">【CF 717F】Heroes of Making Magic III</h1>
<h2 id="题目链接-5"><a href="%22http://codeforces.com/contest/717/problem/F%22">题目链接</a></h2>
<h2 id="题目大意-6">题目大意</h2>
<p>主人公可以从 <span class="math inline">\(i\)</span> 走到 <span class="math inline">\(i-1\)</span> 和 <span class="math inline">\(i+1\)</span>, 给出 <span class="math inline">\(s\)</span> , <span class="math inline">\(s_i\)</span> 表示点 <span class="math inline">\(i\)</span> 需要经过的次数, 操作: 1. <code>1 a b k</code> 区间加, <span class="math inline">\(s_i += k,(i \in [a, b])\)</span>; 2. <code>2 a b</code> 区间查询, 主人公从 <span class="math inline">\(a\)</span> 出发, 在 <span class="math inline">\(b\)</span> 停止, 不能出区间, 能否找到符合 <span class="math inline">\(s_i(i \in [a,b])\)</span> 的移动方案;</p>
<h2 id="解题报告-2">解题报告</h2>
<p>稳稳地读错了题。。 NB地理解为随便从哪个点出发到随便哪个点停止, 我英死早!<br> 实际上是很简单的题…<br> 因为需要从一端到另一端, 所以先走一遍, 即<span class="math inline">\(s_i -= 1, (i \in [l, r])\)</span>. <br> 然后可以增加若干回头路, 也就是相邻的两个位置 <span class="math inline">\(s -= 1\)</span> . <br> 如果不在区间上考虑, 把这个判断是否有解的子问题看做一个完整的问题的话, 显然有一个贪心的思路, 就是从前向后, 如果第 <span class="math inline">\(i\)</span> 个位置有剩余 <span class="math inline">\(left_i\)</span> , 则 <span class="math inline">\(left_{i+1} -= left_{i}\)</span> , 中途如果有 <span class="math inline">\(left_i &lt; 0\)</span> 那么无解, 如果$ left_n != 0$ , 也就是没有消完, 那么无解;<br> 向区间上考虑, 需要维护区间<span class="math inline">\(left\)</span>的最小值和右端点的值;<br> 再考虑合并, <span class="math inline">\(a\)</span> 和 <span class="math inline">\(b\)</span> 两个区间的合并, <span class="math inline">\(a\)</span> 的右端点会对 <span class="math inline">\(b\)</span> 的奇数位置偶数位置产生不同的影响, 所以需要把区间的奇数位置, 偶数位置分别记最小值, 并且需要记录区间的大小, 从而更新右端点的值;<br> 解决区间修改的问题, 通过<span class="math inline">\(left\)</span>的计算方式, 区间修改只会影响区间中的偶位置(从0标号), 需要标记和下传; <br></p>
<h2 id="代码-5">代码</h2>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FORU(i, a, b) for (int i = a, nn = int(b); i &lt;= nn; ++i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FORD(i, a, b) for (int i = a, nn = int(b); i &gt;= nn; --i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> REP(i, b) for (int i = 0, nn = int(b); i &lt; nn; ++i)</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll; </div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> inf = <span class="number">1000000007</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">800050</span>; </div><div class="line"></div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span> </div><div class="line">    ll siz, evmn, odmn, r, tag; </div><div class="line">    node() &#123;siz = r = tag = <span class="number">0</span>, evmn = odmn = inf;&#125; </div><div class="line">    node(ll siz, ll ev, ll od, ll r, ll tag)</div><div class="line">        : siz(siz), evmn(ev), odmn(od), r(r), tag(tag)&#123;&#125; </div><div class="line">    <span class="keyword">void</span> <span class="keyword">operator</span> += (ll k) &#123; </div><div class="line">        <span class="keyword">if</span> (siz &amp; <span class="number">1</span>) r += k; </div><div class="line">        tag += k, evmn +=k;</div><div class="line">    &#125; </div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123; </div><div class="line">        <span class="built_in">cout</span> &lt;&lt; siz &lt;&lt; <span class="string">' '</span> &lt;&lt; evmn &lt;&lt; <span class="string">' '</span> &lt;&lt; odmn &lt;&lt; <span class="string">' '</span> &lt;&lt; r &lt;&lt;  <span class="string">' '</span> &lt;&lt; tag &lt;&lt; <span class="built_in">endl</span>; </div><div class="line">    &#125; </div><div class="line"></div><div class="line">&#125; t[N], ans; </div><div class="line">node <span class="keyword">operator</span> +(node a, node b) &#123; </div><div class="line">    <span class="function">node <span class="title">c</span><span class="params">(a.siz + b.siz, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span></span>; </div><div class="line">    <span class="keyword">if</span> (a.siz &amp; <span class="number">1</span>) &#123; </div><div class="line">        c.evmn = min(a.evmn, b.odmn + a.r); </div><div class="line">        c.odmn = min(a.odmn, b.evmn - a.r); </div><div class="line">        c.r = b.r + ((b.siz &amp; <span class="number">1</span>)?<span class="number">-1</span>:<span class="number">1</span>) * a.r; </div><div class="line">    &#125; <span class="keyword">else</span> &#123; </div><div class="line">        c.evmn = min(a.evmn, b.evmn - a.r); </div><div class="line">        c.odmn = min(a.odmn, b.odmn + a.r); </div><div class="line">        c.r = b.r + ((b.siz &amp; <span class="number">1</span>)?<span class="number">-1</span>:<span class="number">1</span>) * a.r; </div><div class="line">    &#125; </div><div class="line">    <span class="keyword">return</span> c; </div><div class="line">&#125; </div><div class="line"><span class="keyword">int</span> n, q; </div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">push_up</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; </div><div class="line">    t[x] = t[x &lt;&lt; <span class="number">1</span>] + t[x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>]; </div><div class="line">&#125; </div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">push_down</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; </div><div class="line">    <span class="keyword">if</span> (t[x].tag) &#123; </div><div class="line">        t[x &lt;&lt; <span class="number">1</span>] += t[x].tag; </div><div class="line">        t[x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] += t[x].tag; </div><div class="line">        t[x].tag = <span class="number">0</span>; </div><div class="line">    &#125; </div><div class="line">&#125; </div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123; </div><div class="line">    <span class="keyword">if</span> (l == r) &#123; </div><div class="line">        t[x].siz = <span class="number">1</span>, <span class="built_in">cin</span> &gt;&gt; t[x].evmn; </div><div class="line">        --t[x].evmn, t[x].r = t[x].evmn; </div><div class="line">        t[x].tag = <span class="number">0</span>; </div><div class="line">    &#125; <span class="keyword">else</span> &#123; </div><div class="line">        <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>; </div><div class="line">        build(x &lt;&lt; <span class="number">1</span>, l, mid); </div><div class="line">        build(x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r); </div><div class="line">        push_up(x); </div><div class="line">    &#125; </div><div class="line">&#125; </div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> L, <span class="keyword">int</span> R, <span class="keyword">int</span> v)</span> </span>&#123; </div><div class="line">    <span class="keyword">if</span> (L &lt;= l &amp;&amp; r &lt;= R) &#123; </div><div class="line">        t[x] += v; </div><div class="line">    &#125; <span class="keyword">else</span> &#123; </div><div class="line">        <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>; push_down(x);</div><div class="line">        <span class="keyword">if</span> (L &lt;= mid) add(x &lt;&lt; <span class="number">1</span>, l, mid, L, R, v); </div><div class="line">        <span class="keyword">if</span> (R &gt; mid) add(x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, L, R, v); </div><div class="line">        push_up(x); </div><div class="line">    &#125; </div><div class="line">&#125; </div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> L, <span class="keyword">int</span> R)</span> </span>&#123; </div><div class="line">    <span class="keyword">if</span> (L &lt;= l &amp;&amp; r &lt;= R) &#123; </div><div class="line">        ans = ans + t[x]; </div><div class="line">    &#125; <span class="keyword">else</span> &#123; </div><div class="line">        <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>; push_down(x); </div><div class="line">        <span class="keyword">if</span> (L &lt;= mid) query(x &lt;&lt; <span class="number">1</span>, l, mid, L, R); </div><div class="line">        <span class="keyword">if</span> (R &gt; mid ) query(x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, L, R); </div><div class="line">    &#125; </div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    ios :: sync_with_stdio(<span class="literal">false</span>); </div><div class="line">    <span class="built_in">cin</span> &gt;&gt; n;</div><div class="line">    build(<span class="number">1</span>, <span class="number">1</span>, n); </div><div class="line">    <span class="keyword">int</span> type, a, b, k; </div><div class="line">    <span class="built_in">cin</span> &gt;&gt; q; </div><div class="line">    <span class="keyword">while</span> (q--) &#123; </div><div class="line">        <span class="built_in">cin</span> &gt;&gt; type; </div><div class="line">        <span class="keyword">if</span> (type == <span class="number">1</span>) &#123; </div><div class="line">            <span class="built_in">cin</span> &gt;&gt; a &gt;&gt; b &gt;&gt; k; </div><div class="line">            add(<span class="number">1</span>, <span class="number">1</span>, n, a + <span class="number">1</span>, b + <span class="number">1</span>, k); </div><div class="line">        &#125; <span class="keyword">else</span> &#123; </div><div class="line">            <span class="built_in">cin</span> &gt;&gt; a &gt;&gt; b ; </div><div class="line">            ans = node(<span class="number">0</span>, inf, inf, <span class="number">0</span>, <span class="number">0</span>); </div><div class="line">            query(<span class="number">1</span>, <span class="number">1</span>, n, a + <span class="number">1</span>, b + <span class="number">1</span>); </div><div class="line">            <span class="keyword">if</span> (ans.evmn &gt;= <span class="number">0</span> &amp;&amp; ans.odmn &gt;=<span class="number">0</span> &amp;&amp; ans.r == <span class="number">0</span>) </div><div class="line">                <span class="built_in">puts</span>(<span class="string">"1"</span>); </div><div class="line">            <span class="keyword">else</span> </div><div class="line">                <span class="built_in">puts</span>(<span class="string">"0"</span>); </div><div class="line">        &#125; </div><div class="line">    &#125; </div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>; </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="cf-720dslalom">【CF 720D】Slalom</h1>
<h2 id="题目链接-6"><a href="http://codeforces.com/contest/720/problem/D" target="_blank" rel="external">题目链接</a></h2>
<h2 id="题目大意-7">题目大意</h2>
<p>从 <span class="math inline">\((1, 1)\)</span> 点到 <span class="math inline">\((m, n)\)</span> 点的不同路径数, 定义两路径不同当且仅当存在一个矩形障碍物分别在这个路径的左右两侧; ## 解题报告 这个题很像TA哥模拟题中的栅栏(之后补出题解); <br> 利用差分, 令 <span class="math inline">\(f[i][j]\)</span> 表示 <span class="math inline">\((i, j)\)</span> 位置比 <span class="math inline">\((i, j-1)\)</span> 位置多出的方案数; <br> 容易得到, <span class="math inline">\(f[i][j]\)</span> 会继承到 <span class="math inline">\(f[i+1][j]\)</span> , 如果<span class="math inline">\(f[i+1][j]\)</span>没有障碍物;<br> 考虑障碍物的作用: ①将当前行列位置的差分信息清空, ②使上一行的部分差分信息汇聚到障碍物下端右侧位置;<br> 可以来个图感受一下: <img src="/cf/2.png" alt="one"> 白色的部分是障碍物, 那么红色位置的差分信息会汇聚到绿色位置; <img src="/cf/3.png" alt="two"> 同样的, 这个图中, ①位置会分别对其上方的位置和绿色位置贡献一个差分+1; <br> 总结一下, 对于当前行, 没有障碍物的位置, 继承上一行的差分, 障碍物最靠下位置差分信息清空, 右端汇聚前一行可以到达的差分信息;<br> 继承信息, 不需要进行操作, 汇聚信息, 需要区间求和和单点修改, 清空信息, 需要区间清零;<br> 所以线段树可以搞定; <br> 查上一行可以到达的左端位置, 使用平衡树(set)很轻松; <br></p>
<h1 id="代码-6">代码</h1>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt; </span></span></div><div class="line"></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FORU(i, a, b) for (int i = a, nn = int(b); i &lt;= nn; ++i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FORD(i, a, b) for (int i = a, nn = int(b); i &gt;= nn; --i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> REP(i, b) for (int i = 0, nn = int(b); i &lt; nn; ++i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> sz(x) (int)(x).size()</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mmst(a, x) memset(a, x, sizeof(a))</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; vi;</div><div class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; pii;</div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> p = <span class="number">1000000007</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1000100</span>; </div><div class="line"></div><div class="line"><span class="built_in">vector</span> &lt;pii&gt; in[N], out[N]; </div><div class="line"><span class="built_in">multiset</span>&lt;<span class="keyword">int</span>&gt; block; </div><div class="line"><span class="keyword">int</span> sm[N &lt;&lt; <span class="number">2</span>], n, m, k; </div><div class="line"><span class="keyword">bool</span> zero[N &lt;&lt; <span class="number">2</span>]; </div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">stop</span><span class="params">(<span class="keyword">int</span> &amp;x)</span> </span>&#123; </div><div class="line">    <span class="built_in">multiset</span>&lt;<span class="keyword">int</span>&gt; :: iterator i; </div><div class="line">    i = block.upper_bound(x); </div><div class="line">    <span class="keyword">if</span> (i != block.begin()) &#123;</div><div class="line">        -- i; <span class="keyword">return</span> *i + <span class="number">1</span>; </div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">1</span>; </div><div class="line">&#125;  </div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">notify</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; </div><div class="line">    zero[x] = <span class="number">1</span>, sm[x] = <span class="number">0</span>; </div><div class="line">&#125; </div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">push_up</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; </div><div class="line">    sm[x] = (sm[x &lt;&lt; <span class="number">1</span>] + sm[x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>]) % p; </div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">push_down</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; </div><div class="line">    <span class="keyword">if</span> (zero[x]) notify(x &lt;&lt; <span class="number">1</span>), notify(x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>), zero[x] = <span class="number">0</span>; </div><div class="line">&#125; </div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123; </div><div class="line">    <span class="keyword">if</span> (l == r) sm[x] == <span class="number">0</span>; </div><div class="line">    <span class="keyword">else</span> &#123; </div><div class="line">        <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>; </div><div class="line">        build(x &lt;&lt; <span class="number">1</span>, l, mid); </div><div class="line">        build(x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r); </div><div class="line">        push_up(x); </div><div class="line">    &#125; </div><div class="line">&#125; </div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">change</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> w, <span class="keyword">int</span> v)</span> </span>&#123; </div><div class="line">    <span class="keyword">if</span> (l == r) sm[x] = v; </div><div class="line">    <span class="keyword">else</span> &#123; </div><div class="line">        <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>; </div><div class="line">        push_down(x); </div><div class="line">        <span class="keyword">if</span> (w &lt;= mid) change(x &lt;&lt; <span class="number">1</span>, l, mid, w, v); </div><div class="line">        <span class="keyword">else</span> change(x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, w, v); </div><div class="line">        push_up(x);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">clear</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> L, <span class="keyword">int</span> R)</span> </span>&#123; </div><div class="line">    <span class="keyword">if</span> (L &lt;= l &amp;&amp; r &lt;= R) notify(x); </div><div class="line">    <span class="keyword">else</span> &#123; </div><div class="line">        <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>; </div><div class="line">        push_down(x); </div><div class="line">        <span class="keyword">if</span> (L &lt;= mid) clear(x &lt;&lt; <span class="number">1</span>, l, mid, L, R); </div><div class="line">        <span class="keyword">if</span> (R &gt; mid) clear(x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid +<span class="number">1</span>, r, L, R); </div><div class="line">        push_up(x); </div><div class="line">    &#125; </div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> L, <span class="keyword">int</span> R)</span> </span>&#123; </div><div class="line">    <span class="keyword">if</span> (L &lt;= l &amp;&amp; r &lt;= R) <span class="keyword">return</span> sm[x]; </div><div class="line">    <span class="keyword">else</span> &#123; </div><div class="line">        <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>, ans = <span class="number">0</span>; </div><div class="line">        push_down(x); </div><div class="line">        <span class="keyword">if</span> (L &lt;= mid) (ans += query(x &lt;&lt; <span class="number">1</span>, l, mid , L, R)) %= p; </div><div class="line">        <span class="keyword">if</span> (R &gt; mid) (ans += query(x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, L, R)) %= p; </div><div class="line">        <span class="keyword">return</span> ans; </div><div class="line">    &#125; </div><div class="line">&#125; </div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123; </div><div class="line">    ios :: sync_with_stdio(<span class="literal">false</span>); </div><div class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; k; </div><div class="line">    <span class="keyword">int</span> x, y, _x, _y; </div><div class="line">    REP(i, k) &#123; </div><div class="line">        <span class="built_in">cin</span> &gt;&gt; x &gt;&gt; y &gt;&gt; _x &gt;&gt; _y; </div><div class="line">        in[y].pb( mp(x, _x) ); </div><div class="line">        out[_y + <span class="number">1</span>].pb( mp(x, _x) ); </div><div class="line">    &#125; </div><div class="line">    build(<span class="number">1</span>, <span class="number">1</span>, n); </div><div class="line">    change(<span class="number">1</span>, <span class="number">1</span>, n, <span class="number">1</span>, <span class="number">1</span>); </div><div class="line">    REP(i, sz(in[<span class="number">1</span>])) &#123;</div><div class="line">        block.insert(in[<span class="number">1</span>][i].fi); </div><div class="line">        block.insert(in[<span class="number">1</span>][i].se); </div><div class="line">    &#125; </div><div class="line">    FORU(i, <span class="number">2</span>, m) &#123; </div><div class="line">        vi delta; </div><div class="line">        REP(j, sz(in[i])) &#123; </div><div class="line">            <span class="keyword">int</span> r = in[i][j].se + <span class="number">1</span>; </div><div class="line">            <span class="keyword">int</span> l = stop(r); </div><div class="line">            <span class="keyword">if</span> (l &lt;= r &amp;&amp; r &lt;= n)</div><div class="line">                delta.pb(query(<span class="number">1</span>, <span class="number">1</span>, n, l, r)); </div><div class="line">            <span class="keyword">else</span> delta.pb(<span class="number">0</span>);</div><div class="line">        &#125; </div><div class="line">        REP(j, sz(in[i])) &#123; </div><div class="line">            <span class="keyword">int</span> r = in[i][j].se + <span class="number">1</span>; </div><div class="line">            <span class="keyword">if</span> (r &lt;= n) </div><div class="line">                change(<span class="number">1</span>, <span class="number">1</span>, n, r, delta[j]); </div><div class="line">        &#125;</div><div class="line">        REP(j, sz(in[i])) &#123;</div><div class="line">            clear(<span class="number">1</span>, <span class="number">1</span>, n, in[i][j].fi, in[i][j].se); </div><div class="line">            block.insert(in[i][j].fi); </div><div class="line">            block.insert(in[i][j].se); </div><div class="line">        &#125; </div><div class="line">        REP(j, sz(out[i])) &#123; </div><div class="line">            block.erase(block.find(out[i][j].fi)); </div><div class="line">            block.erase(block.find(out[i][j].se)); </div><div class="line">        &#125; </div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> l = stop(n); </div><div class="line">    <span class="keyword">int</span> ans = query(<span class="number">1</span>, <span class="number">1</span>, n, l, n); </div><div class="line">    <span class="keyword">return</span> <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>, <span class="number">0</span>; </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="cf-750gnew-year-and-binary-tree-paths">【CF 750G】New Year and Binary Tree Paths</h1>
<h2 id="原题链接"><a href="http://codeforces.com/contest/750/problem/G" target="_blank" rel="external">原题链接</a></h2>
<h2 id="题目大意-8">题目大意</h2>
<p>无限大的一棵完全二叉树上, 节点编号和等于 <span class="math inline">\(k\)</span> 的路径条数;</p>
<h2 id="解题报告-3">解题报告</h2>
<p>考虑路径的 <span class="math inline">\(LCA\)</span> 为 <span class="math inline">\(x\)</span> , 左右两条路径长度(不包括 <span class="math inline">\(x\)</span> )为 <span class="math inline">\(len_a\)</span> , <span class="math inline">\(len_b\)</span> , 路径编号和 <span class="math inline">\(S\)</span> 是多少; <br> <span class="math display">\[S = x * (2^{len_a+1} + 2^{len_b+1} - 3) + 2^{len_b} - 1 + bonus_a + bonus_b\]</span></p>
<p>一条自上而下的路径, 如果一个位置增加 <span class="math inline">\(x\)</span> , 从这个位置开始的长度为 <span class="math inline">\(n\)</span> , 那么增加 <span class="math inline">\(x\)</span> 的收益是 <span class="math inline">\(x * (2^n - 1)\)</span> ;<br> 所以 <span class="math inline">\(S\)</span> 的计算公式中的 <span class="math inline">\(bonus_a\)</span> 和 <span class="math inline">\(bonus_b\)</span> 代表左右两条长度分别为 <span class="math inline">\(len_a - 1\)</span> 和 <span class="math inline">\(len_b - 1\)</span> 的路径通过向右下方移动得到的收益;<br> 计算 <span class="math inline">\(bonus\)</span> 的时候, 因为<span class="math inline">\(2^n -1\)</span>的形式不好统计方案, 而对每一个为一的二进制位获得的收益加一, 再对总收益/2, 正好可以得到向左移动为0, 向右移动为1对应的二进制数;<br> 所以得到 <span class="math inline">\(bonus_a = a * 2 - ones_a\)</span> ,其中 <span class="math inline">\(a\)</span> 表示左右移动得到的二进制数, <span class="math inline">\(bonus_b\)</span> 同理; <br> 一个有效的性质是, <br> <span class="math display">\[bonus_a + bonus_b +2^{len_b} - 1 &lt; 2^{len_a} - 2 + 2^{len_b  + 1} - 3 &lt; 2^{len_a+1} + 2^{len_b+1} - 3\]</span></p>
<p>所以, 如果确定 <span class="math inline">\(len_a\)</span> 和 <span class="math inline">\(len_b\)</span> , 就可以直接计算 <span class="math inline">\(LCA\)</span> ;<br> 然后可以枚举 <span class="math inline">\(ones_a\)</span> 和 <span class="math inline">\(ones_b\)</span> , 将问题转化成, 两个二进制数, 分别有 <span class="math inline">\(len_a - 1\)</span> 和 <span class="math inline">\(len_b - 1\)</span> 位, <span class="math inline">\(1\)</span> 的个数分别为 <span class="math inline">\(ones_a\)</span> , <span class="math inline">\(ones_b\)</span> , 和为 <span class="math inline">\((bonus_a + bonus_b - ones_a - ones_b)/2\)</span> 的方案数, 数位 <span class="math inline">\(dp\)</span> ; <br></p>
<p>时间复杂度 <span class="math inline">\(O(log^6S)\)</span> ;</p>
<h2 id="代码-7">代码</h2>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt; </span></span></div><div class="line"></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FORU(i, a, b) for (int i = a, nn = int(b); i &lt;= nn; ++i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FORD(i, a, b) for (int i = a, nn = int(b); i &gt;= nn; --i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> REP(i, b) for (int i = 0, nn = int(b); i &lt; nn; ++i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> Tgetw(a, w) ((a &gt;&gt; w) &amp; 1)</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</div><div class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; vi;</div><div class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; pii;</div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">150</span>;</div><div class="line"></div><div class="line">ll s, ans;</div><div class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">dp</span><span class="params">(<span class="keyword">int</span> ot, <span class="keyword">int</span> la, <span class="keyword">int</span> lb, ll sm)</span> </span>&#123;</div><div class="line">    <span class="keyword">static</span> ll f[N][<span class="number">2</span>], las[N][<span class="number">2</span>];</div><div class="line">    REP(a, ot + <span class="number">1</span>) REP(re, <span class="number">2</span>) f[a][re] = <span class="number">0</span>;</div><div class="line">    f[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; (<span class="number">1L</span>L &lt;&lt; i) &lt;= sm; ++i) &#123;</div><div class="line">        REP(a, ot + <span class="number">1</span>) REP(re, <span class="number">2</span>) &#123;</div><div class="line">            las[a][re] = f[a][re];</div><div class="line">            f[a][re] = <span class="number">0</span>;</div><div class="line">        &#125;</div><div class="line">        REP(ca, <span class="number">2</span>) <span class="keyword">if</span> (i &lt; la || ca == <span class="number">0</span>)</div><div class="line">            REP(cb, <span class="number">2</span>) <span class="keyword">if</span> (i &lt; lb || cb == <span class="number">0</span>) &#123;</div><div class="line">                REP(re, <span class="number">2</span>) &#123;</div><div class="line">                    <span class="keyword">int</span> dg = ca + cb + re;</div><div class="line">                    <span class="keyword">if</span> ((dg &amp; <span class="number">1</span>) != Tgetw(sm, i))</div><div class="line">                        <span class="keyword">continue</span>;</div><div class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> al = <span class="number">0</span>; al + ca + cb &lt;= ot; ++al)</div><div class="line">                        f[al + ca + cb][dg / <span class="number">2</span>] += las[al][re];</div><div class="line">                &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> f[ot][<span class="number">0</span>];</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="built_in">cin</span> &gt;&gt; s, ans = <span class="number">0</span>;</div><div class="line">    REP(a, <span class="number">59</span>) REP(b, <span class="number">59</span>) &#123;</div><div class="line">        ll mul = (<span class="number">1L</span>L &lt;&lt; a + <span class="number">1</span>) + (<span class="number">1L</span>L &lt;&lt; b + <span class="number">1</span>) - <span class="number">3</span>;</div><div class="line">        ll lca = s / mul ; <span class="keyword">if</span> (!lca) <span class="keyword">continue</span>;</div><div class="line">        ll res = s - lca * mul - ( (<span class="number">1L</span>L &lt;&lt; b) - <span class="number">1</span>);</div><div class="line">        REP(ones, a + b + <span class="number">1</span>) &#123;</div><div class="line">            ll aandb = res + ones;</div><div class="line">            <span class="keyword">if</span> (aandb &lt; <span class="number">0</span> || aandb % <span class="number">2</span> == <span class="number">1</span>) <span class="keyword">continue</span>;</div><div class="line">            aandb /= <span class="number">2</span>;</div><div class="line">            ans += dp(ones, max(a<span class="number">-1</span>, <span class="number">0</span>), max(b<span class="number">-1</span>, <span class="number">0</span>), aandb);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="cf-702ft-shirt">【CF 702F】T-shirt</h1>
<h2 id="原题链接-1"><a href="http://codeforces.com/contest/702/problem/F" target="_blank" rel="external">原题链接</a></h2>
<h2 id="题目大意-9">题目大意</h2>
<p>每个人会先买质量高的东西, 质量相同会先买便宜的东西, 给出 <span class="math inline">\(n\)</span> 个物品各自的质量和价格, 给出 <span class="math inline">\(k\)</span> 个人每个人带的钱, 问每个人能卖几个东西; ## 解题报告</p>
<p>这个裸数据结构题场上没人A, 你逗我?<br> 首先, 针对每个人, 计算他可以买哪些东西真是搞不了, 咋想都别扭. <br> 古人有句话说得好… 正难则反易.<br> 所以考虑每个东西被哪个人买好了..<br> 把人按照剩下的钱排个平衡树, 然后, 物品按照双关键字排序后, 从前向后扫, 对大于当前物品价格的平衡树上的区间, 做答案 <span class="math inline">\(+1\)</span> , 剩余钱数 <span class="math inline">\(-price_i\)</span> 的操作; <br> 有一个问题, 就是做完区间减法后, 平衡树的性质可能被破坏, 那么需要把操作后, 剩余钱数 <span class="math inline">\(&lt;price_i\)</span> 的节点重新插入平衡树的合适位置;<br> 这样不会 <span class="math inline">\(T\)</span> 成狗 ? <br> 好像不会, 证明下: 1. 一个节点被重新加入平衡树的条件是 <span class="math inline">\(price_i &lt; money &lt; 2price_i\)</span>; 2. 这个节点进行完重构操作后, <span class="math inline">\(money&#39; &lt; price_i\)</span> ; 3. <span class="math inline">\(delta_{money} &gt; money * \frac{1}{2}\)</span> , 也就是每个节点最多进行 <span class="math inline">\(log \ money\)</span> 次操作; 4. 时间复杂度是 <span class="math inline">\(O(nlog^2n)\)</span> ; <br></p>
<p>写的是 <code>FHQ Treap</code>, 仍然经历了痛苦的打残-&gt;调试的过程; <br></p>
<h2 id="代码-8">代码</h2>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt; </span></span></div><div class="line"></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FORU(i, a, b) for (int i = a, nn = int(b); i &lt;= nn; ++i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FORD(i, a, b) for (int i = a, nn = int(b); i &gt;= nn; --i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> REP(i, b) for (int i = 0, nn = int(b); i &lt; nn; ++i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> RAND (rand() &lt;&lt; 15 | rand())</span></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</div><div class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; vi;</div><div class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; pii;</div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">200100</span>;</div><div class="line"></div><div class="line"><span class="keyword">int</span> n, c[N], q[N], lin[N], k, b[N], usr[N];</div><div class="line"><span class="keyword">int</span> ans[N];</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></div><div class="line">	<span class="keyword">int</span> l, r, at, bt, sz, a, b, id, key;</div><div class="line">	node()&#123;&#125;</div><div class="line">	node(<span class="keyword">int</span> b, <span class="keyword">int</span> id, <span class="keyword">int</span> key)</div><div class="line">		: b(b), id(id), key(key)&#123;</div><div class="line">			l = r = at = bt = a = <span class="number">0</span>, sz = <span class="number">1</span>;</div><div class="line">		&#125;</div><div class="line">&#125; t[N];</div><div class="line"><span class="keyword">int</span> root;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">in</span><span class="params">(<span class="keyword">int</span> &amp;x)</span> </span>&#123;</div><div class="line">	<span class="keyword">char</span> ch = getchar(); <span class="keyword">int</span> f= <span class="number">1</span>;</div><div class="line">	<span class="keyword">for</span> (; ch &lt; <span class="string">'0'</span> || ch &gt; <span class="string">'9'</span>; ch = getchar())</div><div class="line">		<span class="keyword">if</span> (ch == <span class="string">'-'</span>) f = <span class="number">-1</span>;</div><div class="line">	<span class="keyword">for</span> (x = <span class="number">0</span>; ch &gt;= <span class="string">'0'</span> &amp;&amp; ch &lt;= <span class="string">'9'</span>; ch = getchar())</div><div class="line">		x = x * <span class="number">10</span> + ch - <span class="number">48</span>;</div><div class="line">	x *= f ;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">cmp1</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</div><div class="line">	<span class="keyword">return</span> q[x] == q[y] ? c[x] &lt; c[y] : q[x] &gt; q[y];</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">cmp2</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</div><div class="line">	<span class="keyword">return</span> b[x] &lt; b[y];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">add_a</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">	t[x].a += v, t[x].at += v;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">add_b</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">	t[x].b += v, t[x].bt += v;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">push_up</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">	t[x].sz = <span class="number">1</span>;</div><div class="line">	<span class="keyword">if</span> (t[x].l) t[x].sz += t[t[x].l].sz;</div><div class="line">	<span class="keyword">if</span> (t[x].r) t[x].sz += t[t[x].r].sz;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">push_down</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">	<span class="keyword">if</span> (t[x].at) &#123;</div><div class="line">		<span class="keyword">if</span> (t[x].l) add_a(t[x].l, t[x].at);</div><div class="line">		<span class="keyword">if</span> (t[x].r) add_a(t[x].r, t[x].at);</div><div class="line">		t[x].at  = <span class="number">0</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span> (t[x].bt) &#123;</div><div class="line">		<span class="keyword">if</span> (t[x].l) add_b(t[x].l, t[x].bt);</div><div class="line">		<span class="keyword">if</span> (t[x].r) add_b(t[x].r, t[x].bt);</div><div class="line">		t[x].bt = <span class="number">0</span>;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> *lis)</span> </span>&#123;</div><div class="line">	<span class="keyword">int</span> x ;</div><div class="line">	<span class="keyword">static</span> <span class="keyword">int</span> <span class="built_in">stack</span>[N], top, last;</div><div class="line">	FORU(i, <span class="number">1</span>, k) &#123;</div><div class="line">		x = lis[i], last = <span class="number">0</span>;</div><div class="line">		t[i] = node(b[x], x, RAND);</div><div class="line">		<span class="keyword">while</span> (top &amp;&amp; t[<span class="built_in">stack</span>[top]].key &gt; t[i].key) &#123;</div><div class="line">			last = <span class="built_in">stack</span>[top], push_up(<span class="built_in">stack</span>[top]);</div><div class="line">			<span class="built_in">stack</span>[top--] = <span class="number">0</span>;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span> (top) t[<span class="built_in">stack</span>[top]].r = i;</div><div class="line">		<span class="built_in">stack</span>[++top] = i, t[i].l = last;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">while</span> (top) push_up(<span class="built_in">stack</span>[top--]);</div><div class="line">	<span class="keyword">return</span> <span class="built_in">stack</span>[<span class="number">1</span>];</div><div class="line">&#125;</div><div class="line"><span class="function">pii <span class="title">split</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> k)</span> </span>&#123;</div><div class="line">	<span class="keyword">if</span> (x == <span class="number">0</span>) <span class="keyword">return</span> mp(<span class="number">0</span>, <span class="number">0</span>);</div><div class="line">    push_down(x); pii y;</div><div class="line">	<span class="keyword">if</span> (k == <span class="number">0</span>) <span class="keyword">return</span> mp(<span class="number">0</span>, x);</div><div class="line">	<span class="keyword">int</span> lsize = t[t[x].l].sz;</div><div class="line">	<span class="keyword">if</span> (lsize &gt;= k) &#123;</div><div class="line">		y = split(t[x].l, k);</div><div class="line">		t[x].l = y.se, push_up(x);</div><div class="line">		y.se = x;</div><div class="line">	&#125; <span class="keyword">else</span> &#123;</div><div class="line">		y = split(t[x].r, k - lsize  - <span class="number">1</span>);</div><div class="line">		t[x].r = y.fi, push_up(x);</div><div class="line">		y.fi = x;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> y;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</div><div class="line">	<span class="keyword">if</span> (a * b == <span class="number">0</span>) <span class="keyword">return</span> a + b;</div><div class="line">	push_down(a), push_down(b);</div><div class="line">	<span class="keyword">if</span> (t[a].key &lt; t[b].key) &#123;</div><div class="line">		t[a].r = merge(t[a].r, b);</div><div class="line">		push_up(a); <span class="keyword">return</span> a;</div><div class="line">	&#125; <span class="keyword">else</span> &#123;</div><div class="line">		t[b].l = merge(a, t[b].l);</div><div class="line">		push_up(b); <span class="keyword">return</span> b;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">lower</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">	<span class="keyword">int</span> x = rt, tmp = <span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span> (x) &#123;</div><div class="line">        push_down(x);</div><div class="line">		<span class="keyword">if</span> (t[x].b &lt; v) &#123;</div><div class="line">			tmp += t[t[x].l].sz + <span class="number">1</span>;</div><div class="line">			x = t[x].r;</div><div class="line">		&#125; <span class="keyword">else</span> x = t[x].l;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> tmp;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> &amp;rt)</span> </span>&#123;</div><div class="line">	<span class="keyword">int</span> k = lower(rt, t[x].b);</div><div class="line">	pii droot = split(rt, k);</div><div class="line">	droot.se = merge(x, droot.se);</div><div class="line">	rt = merge(droot.fi, droot.se);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">del</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> &amp;to)</span> </span>&#123;</div><div class="line">	push_down(x);</div><div class="line">	<span class="keyword">if</span> (t[x].l) del(t[x].l, to);</div><div class="line">	<span class="keyword">if</span> (t[x].r) del(t[x].r, to);</div><div class="line">	t[x].l = t[x].r = <span class="number">0</span>;</div><div class="line">    insert(x, to);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">buy</span><span class="params">(<span class="keyword">int</span> price)</span> </span>&#123;</div><div class="line">	<span class="keyword">int</span> k = lower(root, price);</div><div class="line">	pii droot = split(root, k);</div><div class="line">	add_b(droot.se, -price);</div><div class="line">	add_a(droot.se, <span class="number">1</span>);</div><div class="line">	<span class="keyword">int</span> _k = lower(droot.se, price);</div><div class="line">	pii dright = split(droot.se, _k) ;</div><div class="line">	del(dright.fi, droot.fi);</div><div class="line">	root = merge(droot.fi, dright.se);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">	ans[ t[x].id ] = t[x].a;</div><div class="line">	push_down(x);</div><div class="line">	<span class="keyword">if</span> (t[x].l) query(t[x].l);</div><div class="line">	<span class="keyword">if</span> (t[x].r) query(t[x].r);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">itera</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">    push_down(x);</div><div class="line">    <span class="keyword">if</span> (t[x].l) itera(t[x].l);</div><div class="line">    <span class="built_in">cout</span> &lt;&lt; x &lt;&lt; <span class="string">" , "</span> &lt;&lt; t[x].id &lt;&lt; <span class="string">" : "</span> &lt;&lt; t[x].a &lt;&lt; <span class="string">" , "</span> &lt;&lt; t[x].b &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">    <span class="keyword">if</span> (t[x].r) itera(t[x].r);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">	srand(time(<span class="number">0</span>) + <span class="number">217</span>);</div><div class="line">	in(n);</div><div class="line">	FORU(i, <span class="number">1</span>, n) in(c[i]), in(q[i]), lin[i] = i;</div><div class="line">	in(k);</div><div class="line">	FORU(i, <span class="number">1</span>, k) in(b[i]), usr[i] = i;</div><div class="line">	sort(lin + <span class="number">1</span>, lin + <span class="number">1</span> + n, cmp1);</div><div class="line">	sort(usr + <span class="number">1</span>, usr + <span class="number">1</span> + k, cmp2);</div><div class="line">	root = build(usr);</div><div class="line"><span class="comment">//    itera(root);</span></div><div class="line">	FORU(i, <span class="number">1</span>, n) buy(c[lin[i]]);<span class="comment">// itera(root);</span></div><div class="line">	query(root);</div><div class="line">	FORU(i, <span class="number">1</span>, k)</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"%d%c"</span>, ans[i], (i == k)?<span class="string">'\n'</span>:<span class="string">' '</span>);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="cf-678dlena-and-queries">【CF 678D】Lena and Queries</h1>
<h2 id="原题链接-2"><a href="http://codeforces.com/contest/678/problem/F" target="_blank" rel="external">原题链接</a></h2>
<h2 id="题目大意-10">题目大意</h2>
<p>三个操作： 1. 加入一个有序数对<span class="math inline">\((a, b)\)</span>; 2. 查询对于给出的<span class="math inline">\(x\)</span>, <span class="math inline">\(ax+b\)</span>的最大值; 3. 取消<span class="math inline">\(i\)</span>号插入操作;</p>
<h2 id="解题报告-4">解题报告</h2>
<p>开始想的是时间分治, 离线后, 每个插入相当于对一个区间有效;<br> 每次将完全包含当前区间的插入点做成一个凸包, 对区间内的询问点进行查询;<br> 算一下这样的时间复杂度, 每个区间可以表示成 <span class="math inline">\(logn\)</span> 的分治区间, 也就是被插入 <span class="math inline">\(logn\)</span> 次凸包; 询问需要在凸包上三分, 每个询问需要三分 <span class="math inline">\(logn\)</span> 次, 令三分的复杂度是 <span class="math inline">\(T\)</span> , 那么时间复杂度为 <span class="math inline">\(O(nTlogn)\)</span> ; <br> 对于三分复杂度这个问题, 我用的是三等分的做法, 没有去借鉴网上的 <span class="math inline">\(O(3log_{3}n)\)</span> 的说法, 鉴于每次问题规模缩为原问题的 <span class="math inline">\(\frac{2}{3}\)</span>, 每次需要运算两个点的值, 所以我把复杂度写成 <span class="math inline">\(O(2log_{\frac{3}{2}}n)\)</span> , 这样看就是比二分慢不少, 貌似挺科学?<br> 所以这样做的复杂度就是 <span class="math inline">\(O(nlognlog_{\frac{3}{2}}n)\)</span> ; <br> 要写的时候, 突然想到向量集那个题, 受到一些启发, 干脆把时间建成线段树, 然后把点放到线段树上去, 在线段树上查询;<br> 使用标记永久化, 每个点会加入 <span class="math inline">\(logn\)</span> 次, 复杂度是不变的; <br> 这样空间翻倍了, 但写得更板子…<br> A了之后看了眼题解, woc, 这个分块有点科学呀, 而且复杂度根本不差!!!<br> 所以还是应该继续思考…<br></p>
<h2 id="代码-9">代码</h2>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FORU(i, a, b) for (int i = a, nn = int(b); i &lt;= nn; ++i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FORD(i, a, b) for (int i = a, nn = int(b); i &gt;= nn; --i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> REP(i, b) for (int i = 0, nn = int(b); i &lt; nn; ++i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> sz(x) (int)(x).size()</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</div><div class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; vi;</div><div class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; pii;</div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">301000</span>;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">in</span><span class="params">(<span class="keyword">int</span> &amp; x)</span> </span>&#123;</div><div class="line">    <span class="keyword">char</span> ch = getchar();<span class="keyword">int</span> f = <span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span> (; ch &lt; <span class="string">'0'</span> || ch &gt; <span class="string">'9'</span>; ch = getchar())</div><div class="line">    <span class="keyword">if</span> (ch == <span class="string">'-'</span>) f = <span class="number">-1</span>;</div><div class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; ch &gt;= <span class="string">'0'</span> &amp;&amp; ch &lt;= <span class="string">'9'</span>; ch = getchar())</div><div class="line">    x = x * <span class="number">10</span> + ch - <span class="number">48</span>;</div><div class="line">    x *= f;</div><div class="line">&#125;</div><div class="line"><span class="function">ll <span class="title">cross</span><span class="params">(pll a, pll b, pll c)</span> </span>&#123;</div><div class="line">    ll x = a.fi - b.fi, y = a.se - b.se;</div><div class="line">    ll _x = b.fi - c.fi, _y = b.se - c.se;</div><div class="line">    <span class="keyword">return</span> x * _y - y * _x;</div><div class="line">&#125;</div><div class="line"><span class="function">ll <span class="title">val</span><span class="params">(pll a, ll x)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> x * a.fi + a.se;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">convex</span> &#123;</span></div><div class="line">    <span class="built_in">vector</span>&lt; pll &gt; po;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(pll x)</span> </span>&#123;po.pb(x);&#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="built_in">vector</span>&lt; pll &gt; tp; tp = po;</div><div class="line">        po.clear();</div><div class="line">        sort(tp.begin(), tp.end());</div><div class="line">        REP(i, sz(tp)) &#123;</div><div class="line">            <span class="keyword">while</span> (sz(po) &gt;= <span class="number">2</span> &amp;&amp; cross(tp[i], po.back(), po[sz(po)<span class="number">-2</span>]) &lt;= <span class="number">0</span>)</div><div class="line">                po.pop_back();</div><div class="line">            po.pb(tp[i]);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line">    <span class="function">ll <span class="title">query</span><span class="params">(ll x)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> l = <span class="number">0</span>, r = sz(po) <span class="number">-1</span>;</div><div class="line">        ll ans = LLONG_MIN;</div><div class="line">        <span class="keyword">while</span> (l + <span class="number">2</span> &lt; r) &#123;</div><div class="line">            <span class="keyword">int</span> _l = l + (r - l + <span class="number">1</span>) / <span class="number">3</span>;</div><div class="line">            <span class="keyword">int</span> _r = r - (r - l + <span class="number">1</span>) / <span class="number">3</span>;</div><div class="line">            <span class="keyword">if</span> (val(po[_l], x) &gt; val(po[_r], x))</div><div class="line">                r = _r;</div><div class="line">            <span class="keyword">else</span> l = _l;</div><div class="line">        &#125;</div><div class="line">        FORU(i, l, r) ans = max(ans, val(po[i], x));</div><div class="line">        <span class="keyword">return</span> ans;</div><div class="line">    &#125;</div><div class="line">&#125; c[N &lt;&lt; <span class="number">2</span>];</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">int</span> t[N], l[N], r[N], q[N], n;</div><div class="line">pll poi[N];</div><div class="line">ll ans;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> _l, <span class="keyword">int</span> _r, pll p)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (_l &lt;= l &amp;&amp; r &lt;= _r) &#123;</div><div class="line">        <span class="comment">// cout &lt;&lt; l &lt;&lt; ' ' &lt;&lt; r &lt;&lt; ' '&lt;&lt; _l &lt;&lt; ' '&lt;&lt; _r &lt;&lt; endl;</span></div><div class="line">        c[x].add(p); <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (l == r) <span class="keyword">return</span>;</div><div class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</div><div class="line">    <span class="keyword">if</span> (_l &lt;= mid) add(x &lt;&lt; <span class="number">1</span>, l, mid, _l, _r, p);</div><div class="line">    <span class="keyword">if</span> (_r &gt; mid) add(x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, _l, _r, p);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</div><div class="line">     c[x].build();</div><div class="line">     <span class="keyword">if</span> (l == r) <span class="keyword">return</span>;</div><div class="line">     <span class="keyword">int</span> mid = l + r &gt;&gt; <span class="number">1</span>;</div><div class="line">     build(x &lt;&lt; <span class="number">1</span>, l, mid);</div><div class="line">     build(x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r);</div><div class="line"> &#125;</div><div class="line"><span class="function">ll <span class="title">query</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> p, ll _x)</span> </span>&#123;</div><div class="line">    ll ans = LLONG_MIN;</div><div class="line">    ans = max(ans, c[x].query(_x));</div><div class="line">    <span class="keyword">if</span> (l == r) <span class="keyword">return</span> ans;</div><div class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</div><div class="line">    <span class="keyword">if</span> (p &lt;= mid)</div><div class="line">        ans = max(ans, query(x &lt;&lt; <span class="number">1</span>, l, mid, p, _x));</div><div class="line">    <span class="keyword">else</span></div><div class="line">        ans = max(ans, query(x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, p, _x));</div><div class="line">    <span class="keyword">return</span> ans;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    in(n); <span class="keyword">int</span> x, y;</div><div class="line">    FORU(i, <span class="number">1</span>, n) &#123;</div><div class="line">        in(t[i]);</div><div class="line">        <span class="keyword">if</span> (t[i] == <span class="number">1</span>) &#123;</div><div class="line">            in(x), in(y), poi[i] = mp(x, y);</div><div class="line">            l[i] = i, r[i] = n;</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (t[i] == <span class="number">2</span>)</div><div class="line">                in(x), r[x] = i;</div><div class="line">            <span class="keyword">else</span> in(q[i]);</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// cout &lt;&lt; endl;</span></div><div class="line">    FORU(i, <span class="number">1</span>, n) <span class="keyword">if</span> (t[i] == <span class="number">1</span>) &#123;</div><div class="line"><span class="comment">//        cout &lt;&lt; i &lt;&lt; ": " &lt;&lt;  l[i] &lt;&lt; ' ' &lt;&lt; r[i] &lt;&lt; endl;</span></div><div class="line">        add(<span class="number">1</span>, <span class="number">1</span>, n, l[i], r[i], poi[i]);</div><div class="line">    &#125;</div><div class="line">    build(<span class="number">1</span>, <span class="number">1</span>, n);</div><div class="line">    FORU(i, <span class="number">1</span>, n) <span class="keyword">if</span> (t[i] == <span class="number">3</span>) &#123;</div><div class="line">        ans = query(<span class="number">1</span>, <span class="number">1</span>, n, i, q[i]);</div><div class="line">        <span class="keyword">if</span> (ans == LLONG_MIN) <span class="built_in">puts</span>(<span class="string">"EMPTY SET"</span>);</div><div class="line">        <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="cf-700d-huffman-coding-on-segment">【CF 700D】 Huffman Coding on Segment</h1>
<h2 id="原题链接-3"><a href="http://codeforces.com/contest/700/problem/D" target="_blank" rel="external">原题链接:</a></h2>
<h2 id="题目大意-11">题目大意</h2>
<p>区间查询huffman编码 ## 解题报告 学习huffman编码/树的美好童年时光QWQ.<img src="/cf/4.jpg" alt="简直一派胡言" width="80" height="80"></p>
<p>利用huffman编码的定义, 每次最后一个0/1位相当于把两个数合并, 类似于果子合并中的合并; <br> 显然, 出现次数小的应该先进行合并, 这样可以减小总的编码长度, 答案是所有数的huffman编码长度和, 也就是编码过程中huffman树的每个点的深度和;<br> 所以问题实际上是对一个区间内, 每个数的出现次数为权值构建huffman树…(<del>怎么神犇根本不需要想就知道呀…</del>)<br> 但是一个直接每个区间构建huffman树是 <span class="math inline">\(O(n^2logn)\)</span> 的…<img src="/cf/5.jpg" width="80" height="70"></p>
<p>考虑优化, 貌似出现次数相同的果子(…)可以一起处理, 也就是如果出现次数是 <span class="math inline">\(times\)</span> 的果子一共有 <span class="math inline">\(k\)</span> 个, 那么如果当前最小出现次数果子的出现次数就是 <span class="math inline">\(times\)</span> , 就可以直接合并出 <span class="math inline">\(\lfloor k/2 \rfloor\)</span> 个 <span class="math inline">\(times * 2\)</span>, 如果还剩下一个果子, 就向后面寻找配对的果子…<br> 这个复杂度就很科学了! 因为不同的出现次数只有 <span class="math inline">\(\sqrt{n}\)</span> 种, 而类似桶排, 可以对 <span class="math inline">\(times &lt;= O(sqrt{n})\)</span> 做这样的处理, 使得剩下的果子出现次数 <span class="math inline">\(times &gt; \sqrt{n}\)</span> … 而这样的果子最多 <span class="math inline">\(n / \sqrt{n}\)</span> 个… <img src="/cf/6.gif"></p>
<p>现在的问题是, 怎样统计区间内每个数出现的次数和出现相应次数的有几个数, 连我这个蒟蒻都会的莫队算法可以搞呀..<br> 妙! 复杂度是 <span class="math inline">\(O(n \sqrt{n} + n \sqrt{n} + n \sqrt{n}log \sqrt{n})\)</span> <br></p>
<h2 id="代码-10">代码</h2>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FORU(i, a, b) for (int i = a, nn = int(b); i &lt;= nn; ++i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FORD(i, a, b) for (int i = a, nn = int(b); i &gt;= nn; --i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> REP(i, b) for (int i = 0, nn = int(b); i &lt; nn; ++i)</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</div><div class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; vi;</div><div class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; pii;</div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">100100</span>;</div><div class="line"></div><div class="line"><span class="keyword">int</span> car[N], tim[N], n, q, a[N];</div><div class="line"><span class="keyword">int</span> id[N], B, blo[N], l[N], r[N] ;</div><div class="line">ll ans[N];</div><div class="line">vi large;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> blo[l[a]] == blo[l[b]] ? r[a] &lt; r[b]</div><div class="line">        : blo[l[a]] &lt; blo[l[b]];</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">colorify</span><span class="params">(<span class="keyword">int</span> w, <span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">    tim[car[w]] --, car[w] += v, tim[car[w]] ++;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">got_ans</span><span class="params">(ll &amp;ans)</span> </span>&#123;</div><div class="line">    ans = <span class="number">0</span>;</div><div class="line">    <span class="keyword">static</span> <span class="keyword">int</span> tis[N];</div><div class="line">    FORU(i, <span class="number">1</span>, B * <span class="number">2</span>) tis[i] = tim[i];</div><div class="line">    FORU(i, <span class="number">1</span>, B) &#123;</div><div class="line">        ans += tis[i] / <span class="number">2</span> * <span class="number">2</span> * i;</div><div class="line">        tis[i * <span class="number">2</span>] += tis[i] / <span class="number">2</span>;</div><div class="line">        tis[i] = tis[i] % <span class="number">2</span>;</div><div class="line">        <span class="keyword">if</span> (tis[i]) FORU(j, i + <span class="number">1</span>, B) &#123;</div><div class="line">            <span class="keyword">if</span> (tis[j]) &#123;</div><div class="line">                ans += i + j;</div><div class="line">                tis[i] --, tis[j]--;</div><div class="line">                tis[i + j] ++;</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    priority_queue&lt;<span class="keyword">int</span>, vi, greater&lt;<span class="keyword">int</span>&gt; &gt; q;</div><div class="line">    FORU(i, <span class="number">1</span>, B * <span class="number">2</span>) REP(j, tis[i]) q.push(i);</div><div class="line">    REP(i, sz(large))</div><div class="line">        <span class="keyword">if</span> (car[large[i]] &gt; B * <span class="number">2</span>)</div><div class="line">            q.push(car[large[i]]);</div><div class="line">    <span class="keyword">int</span> x, y;</div><div class="line">    <span class="keyword">while</span> (q.size() &gt;= <span class="number">2</span>) &#123;</div><div class="line">        x = q.top(), q.pop();</div><div class="line">        y = q.top(), q.pop();</div><div class="line">        ans += x + y;</div><div class="line">        q.push(x + y);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    ios :: sync_with_stdio(<span class="literal">false</span>);</div><div class="line">    <span class="built_in">cin</span> &gt;&gt; n , B = <span class="built_in">pow</span>(<span class="number">2</span> * n, <span class="number">0.5</span>);</div><div class="line">    FORU(i, <span class="number">1</span>, n) <span class="built_in">cin</span> &gt;&gt; a[i], ++car[a[i]];</div><div class="line">    FORU(i, <span class="number">1</span>, <span class="number">100000</span>) <span class="keyword">if</span> (car[i] &gt; B * <span class="number">2</span>) large.pb(i);</div><div class="line">    mmst(car, <span class="number">0</span>);</div><div class="line">    <span class="keyword">int</span> tmp = <span class="number">0</span>;</div><div class="line">    FORU(i, <span class="number">1</span>, n) <span class="keyword">if</span> (i % B == <span class="number">0</span>)</div><div class="line">        blo[i] = tmp ++;</div><div class="line">    <span class="keyword">else</span> blo[i] = tmp;</div><div class="line">    <span class="built_in">cin</span> &gt;&gt; q;</div><div class="line">    FORU(i, <span class="number">1</span>, q) id[i] = i;</div><div class="line">    FORU(i, <span class="number">1</span>, q) <span class="built_in">cin</span> &gt;&gt; l[i] &gt;&gt; r[i];</div><div class="line">    sort(id + <span class="number">1</span>, id + <span class="number">1</span> + q, cmp);</div><div class="line">    <span class="keyword">int</span> _l = <span class="number">1</span>, _r = <span class="number">0</span>, __l, __r, x;</div><div class="line">    FORU(i, <span class="number">1</span>, q) &#123;</div><div class="line">        x = id[i], __l = l[x], __r = r[x];</div><div class="line">        <span class="keyword">while</span> (_r &lt; __r)</div><div class="line">            ++_r, colorify(a[_r], <span class="number">1</span>);</div><div class="line">        <span class="keyword">while</span> (_l &gt; __l)</div><div class="line">            --_l, colorify(a[_l], <span class="number">1</span>);</div><div class="line">        <span class="keyword">while</span> (_r &gt; __r)</div><div class="line">            colorify(a[_r], <span class="number">-1</span>), --_r;</div><div class="line">        <span class="keyword">while</span> (_l &lt; __l)</div><div class="line">            colorify(a[_l], <span class="number">-1</span>), ++_l;</div><div class="line">        got_ans(ans[x]);</div><div class="line">    &#125;</div><div class="line">    FORU(i, <span class="number">1</span>, q) <span class="built_in">cout</span> &lt;&lt; ans[i] &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="cf-755gpolandball-and-many-other-balls">【CF 755G】PolandBall and Many Other Balls</h1>
<h2 id="题目链接-7"><a href="http://codeforces.com/contest/755/problem/G" target="_blank" rel="external">题目链接</a></h2>
<h2 id="题目大意-12">题目大意</h2>
<p>一排石子, 相邻的一块, 问<span class="math inline">\(n\)</span>个石子, 圈出<span class="math inline">\(k\)</span>个单位的方案数.</p>
<h2 id="解题报告-5">解题报告</h2>
<p>很容易想到<strong>倍增</strong>, 分为两种情况考虑 :</p>
<ol style="list-style-type: decimal">
<li>当前石子数<span class="math inline">\(x\)</span>, 变为<span class="math inline">\(2x\)</span> , 对于选出<span class="math inline">\(k\)</span>个单位的方案, 显然可以分成左边选<span class="math inline">\(j\)</span>个, 右边选<span class="math inline">\(k-j\)</span>个两部分. 但是有一种特殊的情况, 就是就是将第<span class="math inline">\(x\)</span>块和第<span class="math inline">\(x+1\)</span>块圈成一块, 那么方案数还需要加上在左边<span class="math inline">\((x-1)\)</span>块中选<span class="math inline">\(j\)</span>, 右边<span class="math inline">\((x-1)\)</span>块中选<span class="math inline">\(k-j\)</span>这种情况.</li>
<li>当前石子数为<span class="math inline">\(x\)</span>, 变为<span class="math inline">\(x+1\)</span>, 这个是简单的dp, <span class="math inline">\(f[x][k] = f[x-1][k]+f[x-1][k-1]+f[x-2][k-1]\)</span> 使用当前的<span class="math inline">\(x\)</span>和<span class="math inline">\(x-1\)</span>的信息尽可以转移.</li>
</ol>
<p>上面的两种情况有一个问题, 就是当<span class="math inline">\(x-&gt;2x\)</span> , 没有统计出<span class="math inline">\(2x-1\)</span>的信息.</p>
<p>考虑<span class="math inline">\(2x-1 = x+x-1\)</span> , 也就是左边<span class="math inline">\(x\)</span>和右边<span class="math inline">\(x-1\)</span>或者左边<span class="math inline">\(x-1\)</span>右边<span class="math inline">\(x\)</span> . 但是这两个情况又有重叠, 其实就是第一种情况左边的<span class="math inline">\(x\)</span>将最后一个位置单独圈成一个单位, 和第二种情况右边的<span class="math inline">\(x\)</span>将第一个位置单独圈成一个单位后, 得到的答案是重复的, 所以需要减去重复的答案.</p>
<p>整理一下, 可以得到完整的转移: <span class="math display">\[
\left.
\begin{array}{l}
&amp;f[x][k]=f[x-1][k]+f[x-1][k-1]+f[x-2][k-1]\\
&amp;f[2x] (k) = (f[x] \otimes f[x])(k) + (f[x-1] \otimes f[x-1])(k-1)\\
&amp;f[2x-1] (k) = 2(f[x] \otimes f[x-1])(k) - (f[x-1] \otimes f[x-1])(k-1)
\end{array}
\right.
\]</span></p>
<p>NTT, 大力优化一波卷积.</p>
<h2 id="代码-11">代码</h2>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt; </span></span></div><div class="line"></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FORU(i, a, b) for (int i = int(a), nn = int(b); i &lt;= nn; ++i) </span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FORD(i, a, b) for (int i = int(a), nn = int(b); i &gt;= nn; --i) </span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> REP(i, b) for (int i = 0, nn = int(b); i &lt; b; ++i) </span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> DEBUG(x) cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" : "</span> &lt;&lt; x &lt;&lt; endl</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll; </div><div class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> ff; </div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> K = <span class="number">1</span> &lt;&lt; <span class="number">16</span>; </div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> p = <span class="number">998244353</span>; </div><div class="line"></div><div class="line"><span class="keyword">int</span> n, k, _n, re[K]; </div><div class="line">ll f[K], g[K]; </div><div class="line"></div><div class="line"><span class="keyword">inline</span> ll _fast(ll x, <span class="keyword">int</span> k) &#123;</div><div class="line">	ll ans = <span class="number">1</span>; </div><div class="line">	<span class="keyword">for</span> (; k; k &gt;&gt;= <span class="number">1</span>) &#123; </div><div class="line">		<span class="keyword">if</span> (k &amp; <span class="number">1</span>) ans = ans * x % p; </div><div class="line">		x = x * x % p ; </div><div class="line">	&#125; </div><div class="line">	<span class="keyword">return</span> ans; </div><div class="line">&#125; </div><div class="line"></div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">ad</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line"> 	<span class="keyword">if</span> (x &gt;= p) x -= p ; </div><div class="line"> 	<span class="keyword">if</span> (x &lt; <span class="number">0</span>) x += p; </div><div class="line"> 	<span class="keyword">return</span> x; </div><div class="line">&#125;</div><div class="line">  </div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">fft</span><span class="params">(ll *a, <span class="keyword">int</span> f = <span class="number">1</span>)</span> </span>&#123;</div><div class="line"> 	REP(i, _n) <span class="keyword">if</span> (i &lt; re[i]) </div><div class="line"> 		swap(a[i], a[ re[i] ]); </div><div class="line"> 	ll G = (f == <span class="number">1</span>) ? <span class="number">3</span> : _fast(<span class="number">3</span>, p<span class="number">-2</span>); </div><div class="line"> 	<span class="keyword">for</span> (<span class="keyword">int</span> m=<span class="number">1</span>; m &lt; _n; m &lt;&lt;= <span class="number">1</span>) &#123; </div><div class="line"> 		ll wn = _fast(G, (p<span class="number">-1</span>) / m / <span class="number">2</span>); </div><div class="line"> 		<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i &lt; _n; i += m &lt;&lt; <span class="number">1</span>) &#123; </div><div class="line"> 			ll w = <span class="number">1</span>; </div><div class="line"> 			<span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">0</span>; j &lt; m; ++j) &#123;</div><div class="line"> 				ll x = a[i+j], y = a[i+j+m] * w % p; </div><div class="line"> 				a[i+j] = ad(x + y), a[i+j+m] = ad(x - y); </div><div class="line"> 				w = w * wn % p;</div><div class="line"> 			&#125; </div><div class="line"> 		&#125; </div><div class="line"> 	&#125; </div><div class="line"> 	<span class="keyword">if</span> (f == <span class="number">-1</span>) &#123; </div><div class="line">	 	ll po = _fast(_n, p<span class="number">-2</span>); </div><div class="line">	 	REP(i, _n) a[i] = a[i] * po % p; </div><div class="line">	&#125;</div><div class="line"> 	</div><div class="line">&#125; </div><div class="line"></div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">one</span><span class="params">()</span> </span>&#123;</div><div class="line"> 	FORD(i, k, <span class="number">1</span>) &#123;</div><div class="line"> 	 	g[i] = f[i]; </div><div class="line"> 	 	f[i] = ad(ad(f[i] + f[i<span class="number">-1</span>]) + g[i<span class="number">-1</span>]); </div><div class="line"> 	&#125;</div><div class="line"> 	g[<span class="number">0</span>] = f[<span class="number">0</span>]; </div><div class="line">&#125;  </div><div class="line"></div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">two</span><span class="params">()</span> </span>&#123;</div><div class="line"> 	fft(f), fft(g); </div><div class="line"> 	ll w = <span class="number">1</span>, wn = _fast(<span class="number">3</span>, (p<span class="number">-1</span>)/_n), _f, _g; </div><div class="line"> 	REP(i, _n) &#123; </div><div class="line"> 		_f = (f[i] * f[i] + g[i] * g[i] % p * w) % p; </div><div class="line"> 		_g = (f[i] * g[i] * <span class="number">2</span> - (g[i] * g[i]) % p * (w + <span class="number">1</span>)) % p; </div><div class="line"> 		f[i] = _f, g[i] = ad(_g), w = w * wn % p; </div><div class="line"> 	&#125; </div><div class="line"> 	fft(f, <span class="number">-1</span>), fft(g, <span class="number">-1</span>); </div><div class="line"> 	FORU(i, k + <span class="number">1</span>, _n - <span class="number">1</span>) f[i] = g[i] = <span class="number">0</span>; </div><div class="line">&#125; </div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line"> 	</div><div class="line"> 	ios :: sync_with_stdio(<span class="literal">false</span>); </div><div class="line">	<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; k;  </div><div class="line">	<span class="keyword">for</span> (_n = <span class="number">1</span>; _n &lt; k * <span class="number">2</span>; _n &lt;&lt;= <span class="number">1</span>); </div><div class="line"></div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>; i &lt; _n; ++i) &#123;</div><div class="line"> 		re[i] = j; </div><div class="line"> 		<span class="keyword">for</span> (<span class="keyword">int</span> _k = _n&gt;&gt;<span class="number">1</span>; (j^=_k) &lt; _k; _k &gt;&gt;= <span class="number">1</span>); </div><div class="line"></div><div class="line"> 	&#125; </div><div class="line"> 	</div><div class="line">	f[<span class="number">0</span>] = <span class="number">1</span>; 	</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>&lt;&lt;<span class="number">29</span>, s=<span class="number">0</span>; i; i &gt;&gt;= <span class="number">1</span>) &#123;</div><div class="line">	 	<span class="keyword">if</span> (s) two() , s &lt;&lt;= <span class="number">1</span>; </div><div class="line">	 	<span class="keyword">if</span> (n &amp; i) one(), ++ s; </div><div class="line">	&#125; </div><div class="line">	FORU(i, <span class="number">1</span>, k) </div><div class="line">		<span class="built_in">cout</span> &lt;&lt; f[i] &lt;&lt;( (i==k)?<span class="string">'\n'</span>:<span class="string">' '</span>); </div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>; </div><div class="line">&#125;</div></pre></td></tr></table></figure>
	  
	</div>

	<div>
  	<center>
	<div class="pagination">
<ul class="pagination">
	 
				
    	<li class="prev"><a href="/hdu5322/" class="alignleft prev"><i class="fa fa-arrow-circle-o-left"></i>上一页</a></li>
  		

        <li><a href="/archives"><i class="fa fa-archive"></i>Archive</a></li>

		
		   <li class="next"><a href="/pe/" class="alignright next">下一页<i class="fa fa-arrow-circle-o-right"></i></a></li>         
        
	
</ul>
</div>

    </center>
	</div>

    <!-- share -->
    
        

        
<!-- JiaThis Button BEGIN -->
<script type="text/javascript">
var jiathis_config = {data_track_clickback:'true'};
</script>
<script type="text/javascript" src="http://v3.jiathis.com/code/jiathis_r.js?type=left&amp;move=0&amp;btn=l2.gif&amp;uid=2131170" charset="utf-8"></script>
<!-- JiaThis Button END -->



    
	
	<!-- comment -->
	
<section id="comment">
  <h2 class="title">留言</h2>

  
	<div id="uyan_frame"></div>
  
</section>

	</div> <!-- col-md-9/col-md-12 -->
		
	
	<div id="side_meta">
		<div class="col-md-3" id="post_meta"> 

	<!-- date -->
	
	<div class="meta-widget">
	<i class="fa fa-clock-o"></i>
	2017-03-14 
	</div>
	

	<!-- categories -->
    
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#categorys"><i class="fa fa-folder"></i></a>	
    <ul id="categorys" class="tag_box list-unstyled collapse in">
          
  <li>
    <li><a href="/categories/题目集锦/">题目集锦<span>5</span></a></li>
  </li>

    </ul>
	</div>
	

	<!-- tags -->
	
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#tags"><i class="fa fa-tags"></i></a>		  
    <ul id="tags" class="tag_box list-unstyled collapse in">	  
	    
  <li><a href="/tags/线段树/">线段树<span>10</span></a></li> <li><a href="/tags/倍增/">倍增<span>8</span></a></li> <li><a href="/tags/平衡树/">平衡树<span>8</span></a></li> <li><a href="/tags/STL/">STL<span>5</span></a></li> <li><a href="/tags/DP/">DP<span>6</span></a></li> <li><a href="/tags/构造/">构造<span>2</span></a></li> <li><a href="/tags/FFT/">FFT<span>6</span></a></li> <li><a href="/tags/贪心/">贪心<span>3</span></a></li> <li><a href="/tags/codeforces/">codeforces<span>1</span></a></li>
    </ul>
	</div>
		

	<!-- toc -->
	<div class="meta-widget">
	
	   <a data-toggle="collapse" data-target="#toc"><i class="fa fa-bars"></i></a>
	   <div id="toc" class="toc collapse in">
			<ol class="toc-article"><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#cf-739calyona-and-towers"><span class="toc-article-text">【CF 739C】Alyona and towers</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#题目链接"><span class="toc-article-text">题目链接</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#题目大意"><span class="toc-article-text">题目大意</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#解题报告"><span class="toc-article-text">解题报告</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#代码"><span class="toc-article-text">代码</span></a></li></ol></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#cf-739egosha-is-hunting"><span class="toc-article-text">【CF 739E】Gosha is hunting</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#题目链接-1"><span class="toc-article-text">题目链接</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#题目大意-1"><span class="toc-article-text">题目大意</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#解题报告-1"><span class="toc-article-text">解题报告</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#代码-1"><span class="toc-article-text">代码</span></a></li></ol></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#cf-736dpermutations"><span class="toc-article-text">【CF 736D】Permutations</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#题目链接-2"><span class="toc-article-text">题目链接</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#题目大意-2"><span class="toc-article-text">题目大意</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#代码-2"><span class="toc-article-text">代码</span></a></li></ol></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#cf-741carpas-overnight-party-and-mehrdads-silent-entering"><span class="toc-article-text">【CF 741C】Arpa’s overnight party and Mehrdad’s silent entering</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#题目链接-3"><span class="toc-article-text">题目链接</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#题目大意-3"><span class="toc-article-text">题目大意</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#代码-3"><span class="toc-article-text">代码</span></a></li></ol></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#cf-741darpas-letter-marked-tree-and-mehrdads-dokhtar-kosh-paths"><span class="toc-article-text">【CF 741D】Arpa’s letter-marked tree and Mehrdad’s Dokhtar-kosh paths</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#题目大意-4"><span class="toc-article-text">题目大意</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#代码-4"><span class="toc-article-text">代码</span></a></li></ol></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#cf-750enew-year-and-old-subsequence"><span class="toc-article-text">【CF 750E】New Year and Old Subsequence</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#题目链接-4"><span class="toc-article-text">题目链接</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#题目大意-5"><span class="toc-article-text">题目大意</span></a></li></ol></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#cf-717fheroes-of-making-magic-iii"><span class="toc-article-text">【CF 717F】Heroes of Making Magic III</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#题目链接-5"><span class="toc-article-text">题目链接</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#题目大意-6"><span class="toc-article-text">题目大意</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#解题报告-2"><span class="toc-article-text">解题报告</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#代码-5"><span class="toc-article-text">代码</span></a></li></ol></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#cf-720dslalom"><span class="toc-article-text">【CF 720D】Slalom</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#题目链接-6"><span class="toc-article-text">题目链接</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#题目大意-7"><span class="toc-article-text">题目大意</span></a></li></ol></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#代码-6"><span class="toc-article-text">代码</span></a></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#cf-750gnew-year-and-binary-tree-paths"><span class="toc-article-text">【CF 750G】New Year and Binary Tree Paths</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#原题链接"><span class="toc-article-text">原题链接</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#题目大意-8"><span class="toc-article-text">题目大意</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#解题报告-3"><span class="toc-article-text">解题报告</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#代码-7"><span class="toc-article-text">代码</span></a></li></ol></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#cf-702ft-shirt"><span class="toc-article-text">【CF 702F】T-shirt</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#原题链接-1"><span class="toc-article-text">原题链接</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#题目大意-9"><span class="toc-article-text">题目大意</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#代码-8"><span class="toc-article-text">代码</span></a></li></ol></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#cf-678dlena-and-queries"><span class="toc-article-text">【CF 678D】Lena and Queries</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#原题链接-2"><span class="toc-article-text">原题链接</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#题目大意-10"><span class="toc-article-text">题目大意</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#解题报告-4"><span class="toc-article-text">解题报告</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#代码-9"><span class="toc-article-text">代码</span></a></li></ol></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#cf-700d-huffman-coding-on-segment"><span class="toc-article-text">【CF 700D】 Huffman Coding on Segment</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#原题链接-3"><span class="toc-article-text">原题链接:</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#题目大意-11"><span class="toc-article-text">题目大意</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#代码-10"><span class="toc-article-text">代码</span></a></li></ol></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#cf-755gpolandball-and-many-other-balls"><span class="toc-article-text">【CF 755G】PolandBall and Many Other Balls</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#题目链接-7"><span class="toc-article-text">题目链接</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#题目大意-12"><span class="toc-article-text">题目大意</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#解题报告-5"><span class="toc-article-text">解题报告</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#代码-11"><span class="toc-article-text">代码</span></a></li></ol></li></ol>
		</div>
	
	</div>
	
    <hr>
	
</div><!-- col-md-3 -->

	</div>
		

</div><!-- row -->
 
<script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=2131170"></script>



	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
  &copy; 2017 shallwe
  
      with help from <a href="http://hexo.io/" target="_blank">Hexo</a> and <a href="http://getbootstrap.com/" target="_blank">Twitter Bootstrap</a>. Theme by <a href="http://github.com/wzpan/hexo-theme-freemind/">Freemind</a>.    
</p> </footer>
</div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>▲</span> 
</a>

<script type="text/javascript" color="0,0,0" opacity='1.0' zIndex="-2" count="200" src="/js/src/particle.js"></script>  
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



   <script type="text/javascript">      
     var search_path = "search.xml";
	 if (search_path.length == 0) {
	 	search_path = "search.xml";
	 }
	 var path = "/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
   </script>

</body>
   </html>
