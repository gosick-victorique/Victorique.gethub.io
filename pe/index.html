<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>projecteuler-选做 | shallwe|code</title>
  <meta name="author" content="shallwe">
  
  <meta name="description" content="OI-blog">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="projecteuler-选做"/>
  <meta property="og:site_name" content="shallwe|code"/>

  
    <meta property="og:image" content="undefined"/>
  

  
    <link rel="alternative" href="/atom.xml" title="shallwe|code" type="application/atom+xml">
  
  
    <link href="/favicon.ico" rel="icon">
  

  <!-- CSS -->
  <link rel="stylesheet" href="/css/themes/bootstrap.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML'></script>
  <!-- analytics -->
  
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-97384825-1', 'auto');
  ga('send', 'pageview');
</script>



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?26e751f78e8841e981f7e01910d5fbf6";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>


</head>

 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
	<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
       <a class="navbar-brand" href="/">shallwe|code</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" title="All the articles.">
			  <i class="fa fa-archive"></i>归档页
			</a>
		  </li>
		  
		  <li>
			<a href="/categories" title="All the categories.">
			  <i class="fa fa-folder"></i>分类页
			</a>
		  </li>
		  
		  <li>
			<a href="/tags" title="All the tags.">
			  <i class="fa fa-tags"></i>标签页
			</a>
		  </li>
		  
		  <li>
			<a href="/friend" title="All the friends.">
			  <i class="fa fa-link"></i>小伙伴
			</a>
		  </li>
		  
		  <li>
			<a href="/about" title="About me.">
			  <i class="fa fa-user"></i>博主是个蒟蒻
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 


	
		<div class="page-header page-header-inverse ">		
			<h1 class="title title-inverse "> projecteuler-选做</h1>
		</div>		
	






<div class="row post">
	<!-- cols -->
	
	<div id="top_meta"></div>
	<div class="col-md-9">
	

	<!-- content -->
	<div class="mypage">		
	  		

	  <blockquote>
<p>通过做project euler上的题目， 做一些数学方面的练习</p>
</blockquote>
<a id="more"></a>
<h1 id="project-euler-439"><a href="https://projecteuler.net/problem=439" target="_blank" rel="external">Project Euler #439</a></h1>
<h2 id="题目大意">题目大意</h2>
<p><span class="math display">\[\displaystyle S(N) = \sum_{1 \leqslant i \leqslant N} \sum_{1 \leqslant j \leqslant N} d(i * j)\]</span> <span class="math display">\[d(n) = \sum _{k|n} k\]</span> ## 解题报告 本来想新年第一天搞一发, 但是可怜的是当天没调出来; <br> 首先将式子化简: <span class="math display">\[d(i*j) = \sum \frac{j * p}{q} (p|i,q|j,(p,q)=1) \]</span> <span class="math display">\[S(n) = \sum_{i=1}^{n} \sum_{j=1}^{n}[(p,q)=1] \ p * \sum _{i*p \leqslant n} \sum_{j * q \leqslant n} j\]</span> <span class="math display">\[S(n) = \sum_{p=1}^{n} \sum_{q=1}^{n} \sum_{d|(p,q)} \mu (d)\ p * \sum_{i * p \leqslant n} \sum_{j * q \leqslant n} j\]</span> <span class="math display">\[S(n) = \sum_{d=1}^{n} \mu(d)d \sum_{pd \leqslant n} p\sum_{i * pd \leqslant n} \  \sum_{qd \leqslant n}\sum_{j * qd \leqslant n}j\]</span> 如果把式子中的 <span class="math inline">\(\lfloor \frac{n}{d} \rfloor\)</span> 设为 <span class="math inline">\(I\)</span> , 则 <span class="math display">\[S(n) = \sum_{d=1}^{n} \mu(d)d (\sum_{i}^I\sum_{d|i}d)^2\]</span> 现在就可以做了, 前半部分是我刚学习的杜教筛, 后半部分只有 <span class="math inline">\(\sqrt{n}\)</span> 个取值, 是约数和可以直接分块求;</p>
<p>预处理 <span class="math inline">\(O(n^{\frac{2}{3}})\)</span> , 总复杂度变成 <span class="math inline">\(O(n^{\frac{2}{3}})\)</span> ; 目前没有解决的是复杂度的分析证明…</p>
<h1 id="project-euler-310"><a href="https://projecteuler.net/problem=310" target="_blank" rel="external">Project Euler #310</a></h1>
<h2 id="题目大意-1">题目大意</h2>
<p>只能取完全平方数的nim游戏, 只有三堆, 问必败局面的数量; ## 解题报告 直接暴力sg函数+暴力dp = <span class="math inline">\(5s\)</span>, 跑出了答案;</p>
<p>但是发现sg函数的值非常密集, 最大的不超过在<span class="math inline">\(\sqrt{n}\)</span> 所以只需要枚举三堆的sg值, 就可以<span class="math inline">\(n^{\frac{3}{2}}\)</span>地得到答案, 这个做法秒出答案;</p>
<h2 id="代码">代码</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FORU(i, a, b) for (int i = a, nn = int(b); i &lt;= nn; ++i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FORD(i, a, b) for (int i = a, nn = int(b); i &gt;= nn; --i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> REP(i, b) for (int i = 0, nn = int(b); i &lt; nn; ++i)</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</div><div class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; vi;</div><div class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; pii;</div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">100010</span>;</div><div class="line"><span class="keyword">int</span> f[N];</div><div class="line">ll g[<span class="number">2</span>][<span class="number">4</span>][<span class="number">130000</span>];</div><div class="line">vi square;</div><div class="line"><span class="built_in">bitset</span>&lt;130000&gt; ap;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    f[<span class="number">0</span>] = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i * i &lt;= <span class="number">100000</span>; ++i)</div><div class="line">        square.pb(i * i) ;</div><div class="line">    FORU(i, <span class="number">1</span>, <span class="number">100000</span>) &#123;</div><div class="line">        ap.reset();</div><div class="line">        REP(j, sz(square)) &#123;</div><div class="line">            <span class="keyword">if</span> (square[j] &gt; i) <span class="keyword">break</span>;</div><div class="line">            ap.<span class="built_in">set</span>(f[i - square[j]]);</div><div class="line">        &#125;</div><div class="line">        REP(j, i + <span class="number">1</span>) <span class="keyword">if</span> (!ap[j]) &#123;</div><div class="line">            f[i] = j; <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    mmst(g, <span class="number">-1</span>);</div><div class="line">    g[<span class="number">1</span>][<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</div><div class="line">    <span class="keyword">int</span> pre, now;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">100000</span>; ++i) &#123;</div><div class="line">        now = i &amp; <span class="number">1</span>, pre = now ^ <span class="number">1</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= <span class="number">3</span>; ++j)</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">130000</span>; ++k)</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">0</span>, tmp = <span class="number">0</span>; l &lt;= j; ++l, tmp ^= f[i])</div><div class="line">                    <span class="keyword">if</span> (g[pre][j - l][k ^ tmp] != <span class="number">-1</span>) &#123;</div><div class="line">                        <span class="keyword">if</span> (g[now][j][k] == <span class="number">-1</span>) g[now][j][k] = <span class="number">0</span>;</div><div class="line">                        g[now][j][k] += g[pre][j-l][k ^ tmp];</div><div class="line">                    &#125;</div><div class="line">        mmst(g[pre], <span class="number">-1</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">cout</span> &lt;&lt; g[<span class="number">0</span>][<span class="number">3</span>][<span class="number">0</span>] &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="project-euler-265"><a href="https://projecteuler.net/problem=265" target="_blank" rel="external">Project Euler #265</a></h1>
<h2 id="题目大意-2">题目大意</h2>
<p>将所有长度为<span class="math inline">\(n\)</span>的二进制数放在一个环中, 使得顺时钟读取的<span class="math inline">\(2^n\)</span>个数不重不漏, 输出<span class="math inline">\(n = 5\)</span>时, 所有合法环对应十进制数值的和; ## 解题报告 不小心开启了刷水模式, 但我也不知道这个题这么简单;</p>
<p>直接枚举环上的二进制位肯定会T, 但是只要预处理出每个二进制数的后继数字(在后4位的末尾加一个0/1), 就可以有效的剪枝;</p>
<p>另一个比较优越的优化, 就是不需要深搜<span class="math inline">\(2^5\)</span>层, 只需要<span class="math inline">\(2^5-4\)</span>层就可以, 这是因为为了避免环状置换, 可以强制让第一个数为<span class="math inline">\(0\)</span>;</p>
<h2 id="代码-1">代码</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt; </span></span></div><div class="line"></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FORU(i, a, b) for (int i = a, nn = int(b); i &lt;= nn; ++i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FORD(i, a, b) for (int i = a, nn = int(b); i &gt;= nn; --i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> REP(i, b) for (int i = 0, nn = int(b); i &lt; nn; ++i)</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</div><div class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; vi;</div><div class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; pii;</div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">34</span>;</div><div class="line"></div><div class="line">vi nxt[N], have;</div><div class="line">ll ans = <span class="number">0</span>;</div><div class="line"><span class="keyword">bool</span> vis[N];</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">last</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> w)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> tmp = <span class="number">0</span>;</div><div class="line">    REP(i, w) tmp |= (<span class="number">1</span> &lt;&lt; i) &amp; x;</div><div class="line">    <span class="keyword">return</span> tmp;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">got</span><span class="params">(vi &amp; v)</span> </span>&#123;</div><div class="line">    ll x = <span class="number">0</span>;</div><div class="line">    REP(i, sz(v)) x = x &lt;&lt; <span class="number">1</span> | v[i];</div><div class="line">    <span class="keyword">return</span> x;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">legal</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">    REP(i, <span class="number">4</span>) &#123;</div><div class="line">        x = last(x, <span class="number">4</span>) &lt;&lt; <span class="number">1</span>;</div><div class="line">        <span class="keyword">if</span> (vis[x]) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> pas, <span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">    <span class="built_in">cout</span> &lt;&lt; pas &lt;&lt; <span class="string">' '</span> &lt;&lt; x &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">    have.pb(x &amp; <span class="number">1</span>);</div><div class="line">    vis[x] = <span class="number">1</span>;</div><div class="line">    <span class="keyword">if</span> (pas == <span class="number">27</span> &amp;&amp; legal(x)) &#123;</div><div class="line">        LOOK(have, <span class="number">0</span>, <span class="number">31</span>);</div><div class="line">        ans += got(have);</div><div class="line">    &#125; <span class="keyword">else</span></div><div class="line">        REP(i, sz(nxt[x]))</div><div class="line">            <span class="keyword">if</span> (!vis[nxt[x][i]])</div><div class="line">                dfs(pas + <span class="number">1</span>, nxt[x][i]);</div><div class="line">    have.pop_back();</div><div class="line">    vis[x] = <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    REP(i, <span class="number">32</span>) &#123;</div><div class="line">        <span class="keyword">int</span> tmp = last(i, <span class="number">4</span>) &lt;&lt; <span class="number">1</span>;</div><div class="line">        <span class="keyword">if</span> (tmp ^ i) nxt[i].pb(tmp);</div><div class="line">        tmp = last(i, <span class="number">4</span>) &lt;&lt; <span class="number">1</span> | <span class="number">1</span>;</div><div class="line">        <span class="keyword">if</span> (tmp ^ i) nxt[i].pb(tmp);</div><div class="line">    &#125;</div><div class="line">    REP(i, <span class="number">4</span>) have.pb(<span class="number">0</span>);</div><div class="line">    dfs(<span class="number">0</span>, <span class="number">0</span>);</div><div class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt;  <span class="built_in">endl</span>;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="project-euler-565"><a href="https://projecteuler.net/problem=565" target="_blank" rel="external">Project Euler #565</a></h1>
<h2 id="date-20161225">Date: 2016/12/25</h2>
<h2 id="题目大意-3">题目大意</h2>
<p><span class="math inline">\([1, 10^{11}]\)</span> 中， 约数和能被<span class="math inline">\(2017\)</span>整除的数的和； ## 解题报告 <span class="math display">\[\sum(n) = \prod \sum p^i = \prod \frac{1-p^{k+1}}{1-p}\]</span></p>
<p>通过打表可以发现，对于一个质数<span class="math inline">\(p\)</span>， 只有一个幂指数<span class="math inline">\(k\)</span>满足<span class="math inline">\(2017| \frac{1-p^{k+1}}{1-p}\)</span>;</p>
<p>并且，通过打表，可以发现，最小的三个<span class="math inline">\(p^k\)</span> 的乘积大于<span class="math inline">\(10^{11}\)</span>, 且<span class="math inline">\(10^{11}\)</span>内， 满足条件的<span class="math inline">\(p^k\)</span>数量很少， 只有<span class="math inline">\(10^4\)</span>左右；</p>
<p>但是问题来了，线性筛法， 不能做<span class="math inline">\(10^{11}\)</span>内的质数；</p>
<p>继续打表， 可以发现， 对于大于<span class="math inline">\(10^6\)</span>的所有合法的<span class="math inline">\(p^k\)</span>, <span class="math inline">\(k = 1\)</span>， 那么可以枚举<span class="math inline">\(10^{11}\)</span>内， <span class="math inline">\(2017\)</span>的倍数<span class="math inline">\(y\)</span>， 然后<span class="math inline">\(\sqrt{n}\)</span>检验<span class="math inline">\(y-1\)</span>是否是质数；</p>
<p>当得到所有的合法的<span class="math inline">\(p^k\)</span>, 他的所有倍数<span class="math inline">\(x(gcd(x, p^k) = p^k)\)</span>添加到答案中，再<span class="math inline">\(O(n^2)\)</span>枚举容斥， 就可以AC;</p>
<p>但问题是， 搞不懂为什么自己的程序在windows10上跑到一半就被当做<strong>病毒</strong>删了！</p>
<p>F××K</p>
<h1 id="project-euler-169"><a href="https://www.hackerrank.com/contests/projecteuler/challenges/euler169" target="_blank" rel="external">Project Euler #169</a></h1>
<h2 id="题目大意-4">题目大意</h2>
<p>一个数表示成<span class="math inline">\(2^i\)</span>形式的方案数， 每个<span class="math inline">\(2^i\)</span>可以使用两次； ## 解题报告 通过打表， 可以发现， 设方案数为<span class="math inline">\(f[x]\)</span>, 则<span class="math inline">\(f[x] = f[y] (x = 2*y-1)\)</span>, <span class="math inline">\(f[x] = f[y] + f[x-1](x = 2 * y)\)</span>;</p>
<p>简单证明: 1. 对于<span class="math inline">\(x = 2*y+1\)</span>, 可以将<span class="math inline">\(y\)</span>的方案中， 所有数全部乘二， 然后加一个单独的1，得到合法方案， 容易证明， 任何将方案中的每个<span class="math inline">\(2^i\)</span>拆解， 都会导致与另一方案重复； 2. 对于<span class="math inline">\(x = 2 * y\)</span>, 首先可以将<span class="math inline">\(y\)</span>的方案中， 所有数乘二，得到若干合法的方案。 然后考虑合法的不与其他方案重复的拆解， 发现只能就某个2拆成2个1，是不会冲突的； 那么去掉拆出的一个1， 就可以等价于f[x-1];</p>
<p>程序实现中，定义了一个30位大整数， 利用两个<code>long long</code>实现；</p>
<h2 id="update">UPDATE</h2>
<p>mrazer 大爷 轻松的搞了一个DP的做法, 比我的科学多了, 复杂度更优越, 关键是, 人家并不是打表看的规律; 链接: http://blog.csdn.net/mrazer/article/details/53898297</p>
<h2 id="代码-2">代码</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FORU(i, a, b) for (int i = a, nn = int(b); i &lt;= nn; ++i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FORD(i, a, b) for (int i = a, nn = int(b); i &gt;= nn; --i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> REP(i, b) for (int i = 0, nn = int(b); i &lt; nn; ++i)</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">50</span>;</div><div class="line"><span class="keyword">const</span> ll ba = <span class="number">1000000000000000L</span>L;</div><div class="line"><span class="comment">/*</span></div><div class="line">int f[12][1000000];</div><div class="line">int main() &#123;</div><div class="line">	f[0][0] = 1;</div><div class="line">	FORU(i, 0, 10) &#123;</div><div class="line">		FORU(j, 0, 1024) f[i+1][j] = f[i][j];</div><div class="line">		FORU(j, (1&lt;&lt;i), 1024)</div><div class="line">			f[i+1][j] += f[i][j-(1&lt;&lt;i)];</div><div class="line">		FORU(j, (2 * (1&lt;&lt;i)), 1024)</div><div class="line">			f[i+1][j] += f[i][j-2*(1&lt;&lt;i)];</div><div class="line">	&#125;</div><div class="line">	FORU(i, 1, 50)</div><div class="line">		if ( !(i &amp; 1) )</div><div class="line">		cout &lt;&lt; i &lt;&lt; ": " &lt;&lt; f[11][i] &lt;&lt; endl;</div><div class="line">	return 0;</div><div class="line">&#125;</div><div class="line">*/</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">bigInteger</span> &#123;</span></div><div class="line">	ll a, b;</div><div class="line">	bigInteger() &#123;a = b = <span class="number">0</span>;&#125;</div><div class="line">	bigInteger(ll a, ll b) :a(a), b(b)&#123;&#125;</div><div class="line">	<span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> bigInteger c) <span class="keyword">const</span>&#123;</div><div class="line">		<span class="keyword">return</span> a == c.a ? b &lt; c.b: a &lt; c.a;</div><div class="line">	&#125;</div><div class="line">	<span class="function">bigInteger <span class="title">div2</span><span class="params">()</span> </span>&#123;</div><div class="line">		bigInteger c;</div><div class="line">		c.b = b / <span class="number">2</span>;</div><div class="line">		<span class="keyword">if</span> (a &amp; <span class="number">1</span>) c.b += ba/<span class="number">2</span>;</div><div class="line">		c.a = a / <span class="number">2</span>;</div><div class="line">		<span class="keyword">return</span> c;</div><div class="line">	&#125;</div><div class="line">	bigInteger <span class="keyword">operator</span> - (<span class="keyword">int</span> x) &#123;</div><div class="line">		bigInteger c = *<span class="keyword">this</span>;</div><div class="line">		c.b -= x;</div><div class="line">		<span class="keyword">if</span> (c.b &lt; <span class="number">0</span>) c.a -= <span class="number">1</span>, c.b += ba;  </div><div class="line">		<span class="keyword">return</span> c;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">&#125;;<span class="comment">// a*10e15 + b</span></div><div class="line"><span class="built_in">map</span>&lt;bigInteger, ll&gt; f;</div><div class="line"><span class="built_in">string</span> s;</div><div class="line"><span class="function">ll <span class="title">dfs</span><span class="params">(bigInteger x)</span> </span>&#123;</div><div class="line">	<span class="keyword">if</span> (f[x]) <span class="keyword">return</span> f[x];</div><div class="line">	<span class="keyword">if</span> (x.b&amp;<span class="number">1</span>) f[x] = dfs(x.div2());</div><div class="line">	<span class="keyword">else</span> f[x] = dfs(x.div2()) + dfs(x<span class="number">-1</span>);</div><div class="line">	<span class="keyword">return</span> f[x];</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="built_in">cin</span> &gt;&gt; s;</div><div class="line">	FORU(i, <span class="number">0</span>, (s.length()<span class="number">-1</span>)/<span class="number">2</span>)</div><div class="line">		swap(s[i], s[ s.length() - i - <span class="number">1</span>]);</div><div class="line">	ll a = <span class="number">0</span>, b = <span class="number">0</span>;</div><div class="line">	FORD(i, <span class="number">14</span>, <span class="number">0</span>) &#123;</div><div class="line">		<span class="keyword">if</span> (i + <span class="number">1</span> &gt; s.length()) <span class="keyword">continue</span>;</div><div class="line">		b = b * <span class="number">10</span> + s[i] - <span class="string">'0'</span>;</div><div class="line">	&#125;</div><div class="line">	FORD(i, <span class="number">28</span>, <span class="number">15</span>) &#123;</div><div class="line">		<span class="keyword">if</span> (i + <span class="number">1</span> &gt; s.length()) <span class="keyword">continue</span>;</div><div class="line">		a =  a * <span class="number">10</span> + s[i] - <span class="string">'0'</span>;</div><div class="line">	&#125;</div><div class="line">	f[bigInteger()] = <span class="number">1</span>; 		</div><div class="line">	<span class="built_in">cout</span> &lt;&lt; dfs(bigInteger(a, b)) &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="project-euler-168"><a href="https://www.hackerrank.com/contests/projecteuler/challenges/euler168" target="_blank" rel="external">Project Euler #168</a></h1>
<h2 id="题目大意-5">题目大意</h2>
<p>定义一个数<span class="math inline">\(x = 10 * a + b\)</span>, 一共有<span class="math inline">\(n\)</span>位，<span class="math inline">\(y=b * 10^{n-1}+a\)</span>, 如果<span class="math inline">\(\displaystyle y=kx(k \in \mathbb{N})\)</span>, 则<span class="math inline">\(x\)</span>是合法的， 求<span class="math inline">\((10, 10^m)\)</span>中，合法数的和的后五位； ## 解题报告</p>
<p>比较简单的一道题， 很容易发现， 只要固定个位数字和<span class="math inline">\(k\)</span>， 利用<span class="math inline">\(y\)</span> 和<span class="math inline">\(x\)</span>的<span class="math inline">\(k\)</span>倍关系以及错位关系， 可以得到长度为<span class="math inline">\(l (l \in [2, m])\)</span>的有可能合法的数；</p>
<p>这些数合法的条件是最高位和个位在处理完进位后满足<span class="math inline">\(k\)</span>的关系；</p>
<p>所以可以通过<span class="math inline">\(O(9 * 9 * m)\)</span>得到所有的合法数， 求和即可；</p>
<h2 id="代码-3">代码</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FORU(i, a, b) for (int i = a, nn = int(b); i &lt;= nn; ++i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FORD(i, a, b) for (int i = a, nn = int(b); i &gt;= nn; --i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> REP(i, b) for (int i = 0, nn = int(b); i &lt; nn; ++i)</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> ff;</div><div class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; vi;</div><div class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; pii;</div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">110</span>;</div><div class="line"></div><div class="line"><span class="keyword">int</span> arr[N], m, ans[N*N], answ;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">add_ans</span><span class="params">(<span class="keyword">int</span> *a, <span class="keyword">int</span> w)</span> </span>&#123;</div><div class="line">	FORU(i, <span class="number">1</span>, w) &#123;</div><div class="line">		ans[i] += a[i];</div><div class="line">		<span class="keyword">if</span> (ans[i] &gt;= <span class="number">10</span>) ans[i] -= <span class="number">10</span>, ans[i + <span class="number">1</span>] += <span class="number">1</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">while</span> (ans[w + <span class="number">1</span>] &gt;= <span class="number">10</span>)</div><div class="line">		++ w, ans[w] -= <span class="number">10</span>, ans[w + <span class="number">1</span>] += <span class="number">1</span>;  </div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="built_in">cin</span> &gt;&gt; m; mmst(ans, <span class="number">0</span>);</div><div class="line">	FORU(k, <span class="number">1</span>, <span class="number">9</span>) FORU(i, <span class="number">1</span>, <span class="number">9</span>) &#123;</div><div class="line">		mmst(arr, <span class="number">0</span>); arr[<span class="number">1</span>] = i;</div><div class="line">		FORU(j,	 <span class="number">2</span>, m) &#123;</div><div class="line">			arr[j] += arr[j - <span class="number">1</span>] * k;</div><div class="line">			arr[j+<span class="number">1</span>] += arr[j] / <span class="number">10</span>;</div><div class="line">			arr[j] %= <span class="number">10</span>;</div><div class="line">			<span class="keyword">if</span> (arr[j + <span class="number">1</span>] + arr[j] * k == arr[<span class="number">1</span>] &amp;&amp; arr[j] != <span class="number">0</span>)</div><div class="line">				add_ans(arr, j);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	answ = <span class="number">5</span>;</div><div class="line">	<span class="keyword">while</span> (ans[answ] == <span class="number">0</span>) answ --;</div><div class="line">	<span class="keyword">if</span> (!answ) ++ answ;</div><div class="line">	FORD(i, answ, <span class="number">1</span>) <span class="built_in">cout</span> &lt;&lt; ans[i]; <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="pe-153investigating-gaussian-integers"><a href="https://projecteuler.net/problem=153" target="_blank" rel="external">【PE 153】Investigating Gaussian Integers</a></h1>
<h2 id="题目大意-6">题目大意</h2>
<p><span class="math inline">\(\frac{n}{a+bi}\)</span> 若能表示成 <span class="math inline">\(k+bi(k, b \in \mathbb{Z})\)</span> 的形式, 则对于 <span class="math inline">\(n\)</span> , <span class="math inline">\((a, b)\)</span> 是一个合法的整数对, <span class="math inline">\(s_n = \sum a[(a, b) \ is \ legal \ for \ n]\)</span> , 求 <span class="math inline">\(\displaystyle \sum_{i=1}^{100000000} s_i\)</span> ; ## 解题报告 合法的等价条件:</p>
<p><span class="math display">\[a^2 + b^2 | gcd(a, b)n\]</span></p>
<p>如果只考虑 <span class="math inline">\(gcd(a, b) = 1\)</span> 的情况, 则 <span class="math inline">\(a^2 + b^2 | n\)</span> ;</p>
<p>如果 <span class="math inline">\(a&#39; = ak, b&#39; = bk\)</span> , 则 <span class="math inline">\(k(a^2 + b^2)|n\)</span> ;</p>
<p>也就是说, 对于 <span class="math inline">\(n\)</span>, 如果互质数对 <span class="math inline">\((a,b), a^2 + b^2 |n\)</span> 那么 <span class="math inline">\((a, b)\)</span> 可以对 <span class="math inline">\(n\)</span> , 造成贡献 <span class="math inline">\(\displaystyle \sum_{k \times (a^2 + b^2)|n}ka\)</span></p>
<p>所以, 对于 <span class="math inline">\(n\)</span> ,</p>
<p><span class="math display">\[s_n = \sum_{d|n}A(d) \times B(n/d)\]</span></p>
<p>其中, <span class="math inline">\(\displaystyle A(n) = \sum_{a^2 + b^2 = n, (a, b) = 1} a\)</span> , <span class="math inline">\(\displaystyle B(n) = \sum_{d|n} d\)</span> ;</p>
<p>求 <span class="math inline">\(B\)</span> ? 直接调和筛法, <span class="math inline">\(O(NlnN)\)</span> ;<br>
求 <span class="math inline">\(A\)</span> ? 把 <span class="math inline">\(a^2 &lt;= 10^8\)</span> 的完全平方数 <span class="math inline">\(n^2\)</span> 组合, 判断互质, 统计, <span class="math inline">\(O(NlnN)\)</span> ;<br>
求 <span class="math inline">\(s = A \times B\)</span> ? 调和筛, <span class="math inline">\(O(NlnN)\)</span> ;</p>
<p>然后 <span class="math inline">\(O(N)\)</span> , 求 <span class="math inline">\(s\)</span> 的和.</p>
<h1 id="pe-184triangles-containing-the-origin"><a href="https://projecteuler.net/problem=184" target="_blank" rel="external">【PE 184】Triangles containing the origin</a></h1>
<h2 id="题目大意-7">题目大意</h2>
<p>在半径为 <span class="math inline">\(r\)</span> 的圆中, 包含原点的整点三角形个数; ## 解题报告 考虑一个三角形 <span class="math inline">\(ABC\)</span> 包含原点的条件, 显然是, <span class="math inline">\(\overrightarrow{OA}, \  \overrightarrow{OB}, \  \overrightarrow{OC}\)</span> 同号;</p>
<p>其实就是固定原点, 按照某个顺序扫过 <span class="math inline">\(ABC\)</span> , 相邻两边转过的角度不超过 <span class="math inline">\(\pi\)</span> ; 这样就有一个 <span class="math inline">\(O(n^2logn)\)</span> 的做法, 也就是按照极角排序后, 枚举两个点, 二分第三个点的范围;</p>
<p>直接不进行排序+二分, 考虑合法三角形点的分布情况: 1. 三个点分别位于一个象限, 这样会空出一个象限: 利用圆和坐标轴的对称性, 可以固定空出的象限, 得到答案 <span class="math inline">\(* 4\)</span>, 具体的, 三个有点的象限中, 相对的两个象限的点形成的线段与第三点在原点的两侧, 可以 <span class="math inline">\(O(n^2)\)</span> 枚举相对两点 + 叉积判断; 2. 三个点有两个点在一个象限, 另一个点在相对的象限: 枚举单独在一个象限的点, 它与原点的连线将相对的象限分为两部分, 分别统计两部分的点的数量并相乘就可以得到枚举的点对答案的贡献, 同样利用对称性, 答案需要乘 <span class="math inline">\(4\)</span> , 复杂度 <span class="math inline">\(O(n^2)\)</span> ; 3. 三个点有一个在坐标轴上, 另外两个点在对侧相邻的两个象限: 这个情况最简单, 答案就是坐标轴本轴点的数量乘象限内点数量的平方, 答案需要乘 <span class="math inline">\(4\)</span> ; 4. 三个点有一个在坐标轴上, 另外两个在相对的两个象限内: 使用坐标半轴上的点的数量乘第一种情况中相对两点合法个数, 答案乘 <span class="math inline">\(8\)</span> ;</p>
<ol start="5" style="list-style-type: decimal">
<li>两个点在不同的坐标轴上, 第三点在相对的象限内: 用坐标半轴的点数乘一个象限内的点数, 答案乘 <span class="math inline">\(4\)</span> ;</li>
</ol>
<h2 id="代码-4">代码</h2>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FORU(i, a, b) for (int i = a, nn = int(b); i &lt;= nn; ++i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FORD(i, a, b) for (int i = a, nn = int(b); i &gt;= nn; --i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> REP(i, b) for (int i = 0, nn = int(b); i &lt; nn; ++i)</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">10100</span>;</div><div class="line"><span class="keyword">int</span> x;</div><div class="line">ll s;</div><div class="line"><span class="built_in">vector</span>&lt; pii &gt; t;</div><div class="line">ll ans;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> n = <span class="number">105</span>;</div><div class="line">    x = n - <span class="number">1</span>;</div><div class="line">    FORU(i, <span class="number">1</span>, n - <span class="number">1</span>) &#123;</div><div class="line">        <span class="keyword">int</span> haf = <span class="built_in">sqrt</span>(n * n - i * i);</div><div class="line">        <span class="keyword">if</span> (haf * haf + i * i == n * n)</div><div class="line">            -- haf;</div><div class="line">        FORU(j, <span class="number">1</span>, haf) t.pb(mp(i, j));</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> _x, _y, __x, __y;</div><div class="line">    REP(i, sz(t)) REP(j, sz(t)) &#123;</div><div class="line">        _x = t[i].fi, _y = t[i].se;</div><div class="line">        __x = -t[j].fi, __y = -t[j].se;</div><div class="line">        <span class="keyword">if</span> (_x * __y - __x * _y &gt; <span class="number">0</span>)</div><div class="line">            ++ s; <span class="comment">//cout &lt;&lt; _x &lt;&lt; ' ' &lt;&lt; _y &lt;&lt; ' ' &lt;&lt; __x &lt;&lt; ' ' &lt;&lt; __y &lt;&lt; endl;</span></div><div class="line">    &#125;</div><div class="line">    <span class="comment">// cout &lt;&lt; s &lt;&lt; endl;</span></div><div class="line">    REP(i, sz(t)) &#123;</div><div class="line">        <span class="keyword">int</span> a = <span class="number">0</span>, b = <span class="number">0</span>;</div><div class="line">        REP(j, sz(t)) &#123;</div><div class="line">            _x = t[i].fi, _y = t[i].se;</div><div class="line">            __x = -t[j].fi, __y = -t[j].se;</div><div class="line">            <span class="keyword">if</span> (_x * __y - __x * _y &gt; <span class="number">0</span>)</div><div class="line">                ++ a;</div><div class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (_x * __y - __x * _y &lt; <span class="number">0</span>)</div><div class="line">                ++ b;</div><div class="line">        &#125;</div><div class="line"><span class="comment">//        cout &lt;&lt; _x &lt;&lt; ' ' &lt;&lt; _y &lt;&lt; " : " &lt;&lt; a &lt;&lt; ' ' &lt;&lt;b &lt;&lt; endl;</span></div><div class="line">        ans += a * b;</div><div class="line">    &#125;</div><div class="line">    ans = ans * <span class="number">4</span>;</div><div class="line">    ans += (s + x*x) * sz(t) * <span class="number">4</span>;</div><div class="line">    ans += <span class="number">4L</span>L * x * sz(t) * sz(t);</div><div class="line">    ans += <span class="number">8</span> * x * s;</div><div class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="pe-156counting-digits"><a href="https://projecteuler.net/problem=156" target="_blank" rel="external">【PE 156】Counting Digits</a></h1>
<h2 id="题目大意-8">题目大意</h2>
<p><span class="math inline">\(f[n][d]\)</span> 表示前 <span class="math inline">\(n\)</span> 个数中， 数字 <span class="math inline">\(d\)</span> 出现的次数， 求 <span class="math inline">\(\displaystyle \sum_n \sum_{d = 1}^{9} [f[n][d] = n]\)</span> ## 解题报告 利用数位dp, 可以得到第 <span class="math inline">\(f[n][d]\)</span> , 时间复杂度是 <span class="math inline">\(O(logn)\)</span> ;<br>
但是怎么求出所有满足条件的 <span class="math inline">\((n, d)\)</span> ?<br>
对于不同的 <span class="math inline">\(d\)</span> , 寻找满足条件的 <span class="math inline">\(n\)</span> , 显然, 如果 <span class="math inline">\(n = n + 1\)</span> , <span class="math inline">\(f[n][d]\)</span> 可能不变, 最多增加 <span class="math inline">\(w\)</span> , <span class="math inline">\(w\)</span> 是 <span class="math inline">\(n\)</span> 的位数;<br>
那么如果 <span class="math inline">\(abs(n - f[n][d]) = delta\)</span> , 下一个满足条件的 <span class="math inline">\(n\)</span> 最少需要经过 <span class="math inline">\(delta/w\)</span> , 不妨令 <span class="math inline">\(w = 10\)</span> , 因为通过尝试, 发现最大的满足条件的 <span class="math inline">\(n\)</span> 在 <code>int</code> 范围内…<br>
复杂度? 不是很会证, 但可以在 <span class="math inline">\(1s\)</span> 内得到答案;</p>
<h2 id="代码-5">代码</h2>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt; </span></span></div><div class="line"></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FORU(i, a, b) for (int i = a, nn = int(b); i &lt;= nn; ++i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FORD(i, a, b) for (int i = a, nn = int(b); i &gt;= nn; --i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> REP(i, b) for (int i = 0, nn = int(b); i &lt; nn; ++i)</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull; </div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">20</span>;</div><div class="line">ull ans, lim = <span class="number">1L</span>L &lt;&lt; <span class="number">50</span>, step;</div><div class="line">ull pre[N], uu[N];</div><div class="line"><span class="function"><span class="keyword">inline</span> ull <span class="title">got</span><span class="params">(ull n, ull d)</span> </span>&#123;</div><div class="line">    vi w;</div><div class="line">    <span class="keyword">while</span> (n) w.pb(n % <span class="number">10</span>), n /= <span class="number">10</span>;</div><div class="line">    ull ca = <span class="number">0</span>, ans = <span class="number">0</span>; <span class="keyword">int</span> x;</div><div class="line">    FORD(i, sz(w) - <span class="number">1</span>, <span class="number">0</span>) &#123;</div><div class="line">        x = w[i];</div><div class="line">        ans += ca * uu[i] * x;</div><div class="line">        ans += pre[i] * x;</div><div class="line">        <span class="keyword">if</span> (x &gt; d) ans += uu[i];</div><div class="line">        <span class="keyword">if</span> (x == d) ca ++;</div><div class="line">    &#125;</div><div class="line">    ans += ca;</div><div class="line">    <span class="keyword">return</span> ans;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">inline</span> ull <span class="title">query</span><span class="params">(<span class="keyword">int</span> d)</span> </span>&#123;</div><div class="line">    ull n = <span class="number">1</span>,  sm = <span class="number">0</span>; ll step = <span class="number">1</span>;</div><div class="line">    <span class="keyword">while</span> (n &lt; lim) &#123;</div><div class="line">        ull tmp = got(n, d);</div><div class="line">        <span class="keyword">if</span> (tmp - n == <span class="number">0</span>) sm += n;<span class="comment">// cout &lt;&lt; d &lt;&lt; ": " &lt;&lt; n &lt;&lt; endl;</span></div><div class="line">        <span class="keyword">if</span> (tmp &gt; n) step = (tmp - n) / <span class="number">10</span>;</div><div class="line">        <span class="keyword">else</span> step = (n - tmp) / <span class="number">10</span>;</div><div class="line">        <span class="keyword">if</span> (!step) step = <span class="number">1</span>;</div><div class="line">        n += step;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (d == <span class="number">1</span>) <span class="built_in">cout</span> &lt;&lt; sm &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">    <span class="keyword">return</span> sm;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    ull tot = <span class="number">0</span>,  tmp = <span class="number">1</span> ;</div><div class="line">    uu[<span class="number">0</span>] = <span class="number">1</span>;</div><div class="line">    FORU(i, <span class="number">1</span>, <span class="number">16</span>) &#123;</div><div class="line">        tmp = tmp * <span class="number">10</span>;</div><div class="line">        pre[i] = tmp * i / <span class="number">10</span> ;</div><div class="line">        uu[i] = tmp;</div><div class="line">    &#125;</div><div class="line">    FORU(i, <span class="number">1</span>, <span class="number">9</span>) ans += query(i);</div><div class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="pe-157solving-the-diophantine-equation"><a href="https://projecteuler.net/problem=157" target="_blank" rel="external">【PE 157】Solving the diophantine equation</a></h1>
<h2 id="题目大意-9">题目大意</h2>
<p>如果 <span class="math inline">\(\frac{1}{a} + \frac{1}{b} = \frac{p}{10^n}\)</span> , 其中 <span class="math inline">\(a, b, p \in \mathbb{Z}, n \in [1, 9]\)</span> , 那么 <span class="math inline">\((a, b, p, n)\)</span> 向答案贡献 <span class="math inline">\(1\)</span> , 求答案。</p>
<h2 id="解题报告">解题报告</h2>
<p>对题目中的条件进行翻译: <span class="math display">\[\frac{1}{a} + \frac{1}{b} = \frac{p}{10^n} \Leftrightarrow ab|10^n(a+b)\]</span> 如果 <span class="math inline">\((a, b) = 1\)</span> , 那么 <span class="math inline">\(ab|10^n\)</span> ;<br>
如果 <span class="math inline">\((a, b) = k\)</span> , 那么 <span class="math inline">\(kab|10^n\)</span> ;<br>
所以, 可以枚举 <span class="math inline">\((a, b) = 1\)</span> , 使得 <span class="math inline">\(ab|10^n\)</span> , 贡献是 <span class="math inline">\(\frac{10^n(a+b)}{ab}\)</span> 的约数;</p>
<p>可以发现, 能乘除 <span class="math inline">\(10^n\)</span> 的 <span class="math inline">\(a, b((a, b) = 1)\)</span> 导致两种情况: ①<span class="math inline">\(a = 1, b|10^n\)</span> ② <span class="math inline">\(a=2^l, b=5^k, ab|10^n\)</span> , 第二种情况最多 <span class="math inline">\(log_210^n\)</span> 种, 第一种情况大约 <span class="math inline">\(ln10^n\)</span> 种, 所以可以枚举;</p>
<h2 id="代码-6">代码</h2>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt; </span></span></div><div class="line"></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FORU(i, a, b) for (int i = a, nn = int(b); i &lt;= nn; ++i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FORD(i, a, b) for (int i = a, nn = int(b); i &gt;= nn; --i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> REP(i, b) for (int i = 0, nn = int(b); i &lt; nn; ++i)</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</div><div class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; vi;</div><div class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; pii;</div><div class="line"></div><div class="line"><span class="keyword">int</span> lim = <span class="number">1e9</span>, ans;</div><div class="line">vi xy, x, y;</div><div class="line">vi w[<span class="number">1000000</span>];</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> i)</span> </span>&#123;</div><div class="line">    ll _n = <span class="number">1L</span>L * n * (x[i] + y[i]) / xy[i];</div><div class="line">    <span class="keyword">int</span> tmp = <span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span> (ll j = <span class="number">2</span>; j * j &lt;= _n; ++j)</div><div class="line">        <span class="keyword">if</span> (_n % j == <span class="number">0</span>) &#123;</div><div class="line">            <span class="keyword">int</span> k = <span class="number">0</span>;</div><div class="line">            <span class="keyword">while</span> (_n % j == <span class="number">0</span>) ++k, _n/=j;</div><div class="line">            tmp = tmp * (k + <span class="number">1</span>);</div><div class="line">        &#125;</div><div class="line">    <span class="keyword">if</span> (_n &gt; <span class="number">1</span>) tmp = tmp * <span class="number">2</span>;</div><div class="line">    <span class="keyword">if</span> (x[i] != <span class="number">1</span> &amp;&amp; y[i] != <span class="number">1</span>) &#123;</div><div class="line">        <span class="keyword">int</span> _tmp = <span class="number">1</span>;</div><div class="line">        _n = <span class="number">1L</span>L * n * (<span class="number">1</span> + x[i]*y[i]) / xy[i];</div><div class="line">        <span class="keyword">for</span> (ll j = <span class="number">2</span>; j * j &lt;= _n; ++j)</div><div class="line">            <span class="keyword">if</span> (_n % j == <span class="number">0</span>) &#123;</div><div class="line">                <span class="keyword">int</span> k = <span class="number">0</span>;</div><div class="line">                <span class="keyword">while</span> (_n % j == <span class="number">0</span>) ++k, _n/=j;</div><div class="line">                _tmp = _tmp * (k + <span class="number">1</span>);</div><div class="line">            &#125;</div><div class="line">        <span class="keyword">if</span> (_n &gt; <span class="number">1</span>) _tmp = _tmp * <span class="number">2</span>;</div><div class="line">        tmp += _tmp;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (xy[i] &lt; <span class="number">1000000</span>) w[xy[i]].pb(tmp);</div><div class="line">    <span class="keyword">return</span> tmp;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    ans = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; lim; i *= <span class="number">2</span>)</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; lim; j *= <span class="number">5</span>) &#123;</div><div class="line">            <span class="keyword">if</span> (<span class="number">1L</span>L * i * j &gt; lim) <span class="keyword">break</span>;</div><div class="line">            xy.pb(i * j), x.pb(i),  y.pb(j);</div><div class="line">        &#125;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">10</span>; i &lt;= lim; i *= <span class="number">10</span>) &#123;</div><div class="line">        <span class="keyword">int</span> tmp = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; sz(xy); ++j)</div><div class="line">            <span class="keyword">if</span> (i % xy[j] == <span class="number">0</span>)</div><div class="line">                tmp += query(i, j);</div><div class="line">        ans += tmp;</div><div class="line"></div><div class="line">    &#125;</div><div class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="pe-160factorial-trailing-digits"><a href="https://projecteuler.net/problem=160" target="_blank" rel="external">【PE 160】Factorial trailing digits</a></h1>
<h2 id="题目大意-10">题目大意</h2>
<p><span class="math inline">\(10^{12}!\)</span> 去零的后五位; ## 解题报告 1. 首先确定 <span class="math inline">\(10^{12}!\)</span> 次方有几个 <span class="math inline">\(0\)</span> , 其实就是 <span class="math inline">\(10^{12}!\)</span> 中 <span class="math inline">\(10\)</span> 的幂指数 <span class="math inline">\(k_{10}\)</span> , 而 <span class="math inline">\(k_{10} = min(k_{2}, k_{5}) , k_{2} &gt; k_{5}\)</span> , 所以 <span class="math inline">\(k_{10} = k_{5}\)</span> ;<br>
计算 <span class="math inline">\(k_{5}\)</span> ? 令 <span class="math inline">\(n = 10^{12}\)</span> , <span class="math inline">\(5\)</span> 的倍数会分别贡献一个 <span class="math inline">\(5\)</span> , <span class="math inline">\(25\)</span> 的倍数会额外贡献一个 <span class="math inline">\(5\)</span> …<br>
所以 <span class="math inline">\(\displaystyle k_{5} = \sum_{i} \frac{n}{5^i}\)</span><br>
记 <span class="math inline">\(k = k_5\)</span> ; 2. 确定 <span class="math inline">\(\frac{n!}{10^k}(mod \ 10^5)\)</span><br>
这个比较有难度, 因为 <span class="math inline">\(n!\)</span> 中, 有 <span class="math inline">\(5\)</span> , <span class="math inline">\(2\)</span> , 无法直接取模, 但是因为 <span class="math inline">\(n\)</span> 足够的大,所以可以得到, <span class="math inline">\(k_2 - k_5 &gt; 5\)</span> , 也就是 <span class="math inline">\(\frac{n!}{10^k}(mod \ 2^5) = 0\)</span> ,所以如果能求出 <span class="math inline">\(\frac{n!}{10^k}(mod \ 5^5)\)</span> , 使用CRT就可以得到答案(因为 <span class="math inline">\((2^5, 5^5) = 1\)</span> );<br>
将 <span class="math inline">\(n!(mod \ 5^5)\)</span> 中的 <span class="math inline">\(5\)</span> 进行递归提取, 则 <span class="math inline">\(n_i! = 5^{k_5(n_i)} A(n_i) n_{i+1}!\)</span> , 其中 <span class="math inline">\(n_{i+1} = \lfloor \frac{n_i}{5} \rfloor\)</span> . 展开递归式, <span class="math inline">\(n! = 5^{k}A(n!)A(n!/5)A(n!/25)...A(1)\)</span> , 其中 <span class="math inline">\(A(n)\)</span> 表示 <span class="math inline">\([1, n]\)</span> 中与 <span class="math inline">\(5\)</span> 互质的数的乘积, 也就是 <span class="math inline">\(A(n) = \prod_{i=1}^{n} [gcd(i, 5)=1]i\)</span> ;<br>
这个 <span class="math inline">\(A(n)\)</span> 显然存在循环节, 且 <span class="math inline">\(5^5\)</span> 是一个已知的循环节 , 那么可以预处理 <span class="math inline">\(A(1-5^5)\)</span> ;<br>
<span class="math display">\[\frac{5!}{10^k}(mod \ 5^5) = \frac{5^{k}A(n!)A(n!/5)A(n!/25)...A(1)}{5^k2^k}(mod \ 5^5) = 2^{-k}A(n!)A(n!/5)A(n!/25)...A(1)(mod \ 5^5)\]</span> 3. 使用中国剩余定理 .</p>
<p>过程中的逆元需要用拓展欧几里得求. ## 代码</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FORU(i, a, b) for (int i = a, nn = int(b); i &lt;= nn; ++i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FORD(i, a, b) for (int i = a, nn = int(b); i &gt;= nn; --i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> REP(i, b) for (int i = 0, nn = int(b); i &lt; nn; ++i)</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">3126</span>;</div><div class="line"><span class="keyword">int</span> A[N], pre[N] ;</div><div class="line">ll n = <span class="number">1000000000000L</span>L, d;</div><div class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">quick</span><span class="params">(ll x, ll k)</span> </span>&#123;</div><div class="line">     ll ans = <span class="number">1</span>;</div><div class="line">     <span class="keyword">for</span> (; k; k &gt;&gt;= <span class="number">1</span>) &#123;</div><div class="line">         <span class="keyword">if</span> (k &amp; <span class="number">1</span>) ans = ans * x % <span class="number">3125</span>;</div><div class="line">         x = x * x % <span class="number">3125</span>;</div><div class="line">     &#125;</div><div class="line">     <span class="keyword">return</span> ans;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">exd_ou</span><span class="params">(ll a, ll b, ll &amp;x, ll &amp;y)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (!b) x = <span class="number">1</span>, y = <span class="number">0</span>;</div><div class="line">    <span class="keyword">else</span> &#123;</div><div class="line">        exd_ou(b, a % b, y , x);</div><div class="line">        y -= (a/b) * x;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">inline</span> ll _A(ll n) &#123;</div><div class="line">    <span class="keyword">return</span> ((<span class="keyword">int</span>)<span class="built_in">pow</span>(<span class="number">-1</span>, n/<span class="number">3125</span>) * A[n % <span class="number">3125</span>] + <span class="number">3125</span>) % <span class="number">3125</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    ll fiv = <span class="number">5</span>;</div><div class="line"></div><div class="line">    <span class="keyword">for</span> (; fiv &lt;= n; fiv *= <span class="number">5</span>)</div><div class="line">        d += n / fiv;</div><div class="line">    A[<span class="number">0</span>] = <span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; ++i)</div><div class="line">        <span class="keyword">if</span> (i % <span class="number">5</span>) A[i] = A[i<span class="number">-1</span>] * i % <span class="number">3125</span>;</div><div class="line">        <span class="keyword">else</span> A[i] = A[i<span class="number">-1</span>];</div><div class="line">    ll two, rev, tmp ;</div><div class="line">    two = quick(<span class="number">2L</span>L,  d);</div><div class="line">    exd_ou(two, <span class="number">3125</span>, rev, tmp);</div><div class="line">    <span class="keyword">if</span> (rev &lt; <span class="number">0</span>) rev += <span class="number">3125</span>;</div><div class="line">    fiv = <span class="number">1</span>; ll _a = <span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span> (; fiv &lt;= n; fiv *= <span class="number">5</span>)</div><div class="line">        _a = _a * _A(n / fiv) % <span class="number">3125</span>;</div><div class="line">    _a = rev * _a % <span class="number">3125</span>;</div><div class="line">    two = quick(<span class="number">2</span>, <span class="number">5</span>);</div><div class="line">    exd_ou(two, <span class="number">3125</span>, rev, tmp);</div><div class="line">    ll ans = _a * two * rev;</div><div class="line">    <span class="built_in">cout</span> &lt;&lt; ans % <span class="number">100000</span>&lt;&lt; <span class="built_in">endl</span>;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
	  
	</div>

	<div>
  	<center>
	<div class="pagination">
<ul class="pagination">
	 
				
    	<li class="prev"><a href="/cf/" class="alignleft prev"><i class="fa fa-arrow-circle-o-left"></i>上一页</a></li>
  		

        <li><a href="/archives"><i class="fa fa-archive"></i>Archive</a></li>

		
		   <li class="next"><a href="/cc1/" class="alignright next">下一页<i class="fa fa-arrow-circle-o-right"></i></a></li>         
        
	
</ul>
</div>

    </center>
	</div>

    <!-- share -->
    
        

        
<!-- JiaThis Button BEGIN -->
<script type="text/javascript">
var jiathis_config = {data_track_clickback:'true'};
</script>
<script type="text/javascript" src="http://v3.jiathis.com/code/jiathis_r.js?type=left&amp;move=0&amp;btn=l2.gif&amp;uid=2131170" charset="utf-8"></script>
<!-- JiaThis Button END -->



    
	
	<!-- comment -->
	
<section id="comment">
  <h2 class="title">留言</h2>

  
	<div id="uyan_frame"></div>
  
</section>

	</div> <!-- col-md-9/col-md-12 -->
		
	
	<div id="side_meta">
		<div class="col-md-3" id="post_meta"> 

	<!-- date -->
	
	<div class="meta-widget">
	<i class="fa fa-clock-o"></i>
	2017-03-14 
	</div>
	

	<!-- categories -->
    
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#categorys"><i class="fa fa-folder"></i></a>	
    <ul id="categorys" class="tag_box list-unstyled collapse in">
          
  <li>
    <li><a href="/categories/题目集锦/">题目集锦<span>5</span></a></li>
  </li>

    </ul>
	</div>
	

	<!-- tags -->
	
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#tags"><i class="fa fa-tags"></i></a>		  
    <ul id="tags" class="tag_box list-unstyled collapse in">	  
	    
  <li><a href="/tags/筛法/">筛法<span>2</span></a></li> <li><a href="/tags/数论/">数论<span>5</span></a></li> <li><a href="/tags/枚举/">枚举<span>1</span></a></li>
    </ul>
	</div>
		

	<!-- toc -->
	<div class="meta-widget">
	
	   <a data-toggle="collapse" data-target="#toc"><i class="fa fa-bars"></i></a>
	   <div id="toc" class="toc collapse in">
			<ol class="toc-article"><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#project-euler-439"><span class="toc-article-text">Project Euler #439</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#题目大意"><span class="toc-article-text">题目大意</span></a></li></ol></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#project-euler-310"><span class="toc-article-text">Project Euler #310</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#题目大意-1"><span class="toc-article-text">题目大意</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#代码"><span class="toc-article-text">代码</span></a></li></ol></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#project-euler-265"><span class="toc-article-text">Project Euler #265</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#题目大意-2"><span class="toc-article-text">题目大意</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#代码-1"><span class="toc-article-text">代码</span></a></li></ol></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#project-euler-565"><span class="toc-article-text">Project Euler #565</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#date-20161225"><span class="toc-article-text">Date: 2016/12/25</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#题目大意-3"><span class="toc-article-text">题目大意</span></a></li></ol></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#project-euler-169"><span class="toc-article-text">Project Euler #169</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#题目大意-4"><span class="toc-article-text">题目大意</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#update"><span class="toc-article-text">UPDATE</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#代码-2"><span class="toc-article-text">代码</span></a></li></ol></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#project-euler-168"><span class="toc-article-text">Project Euler #168</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#题目大意-5"><span class="toc-article-text">题目大意</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#代码-3"><span class="toc-article-text">代码</span></a></li></ol></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#pe-153investigating-gaussian-integers"><span class="toc-article-text">【PE 153】Investigating Gaussian Integers</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#题目大意-6"><span class="toc-article-text">题目大意</span></a></li></ol></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#pe-184triangles-containing-the-origin"><span class="toc-article-text">【PE 184】Triangles containing the origin</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#题目大意-7"><span class="toc-article-text">题目大意</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#代码-4"><span class="toc-article-text">代码</span></a></li></ol></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#pe-156counting-digits"><span class="toc-article-text">【PE 156】Counting Digits</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#题目大意-8"><span class="toc-article-text">题目大意</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#代码-5"><span class="toc-article-text">代码</span></a></li></ol></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#pe-157solving-the-diophantine-equation"><span class="toc-article-text">【PE 157】Solving the diophantine equation</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#题目大意-9"><span class="toc-article-text">题目大意</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#解题报告"><span class="toc-article-text">解题报告</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#代码-6"><span class="toc-article-text">代码</span></a></li></ol></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#pe-160factorial-trailing-digits"><span class="toc-article-text">【PE 160】Factorial trailing digits</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#题目大意-10"><span class="toc-article-text">题目大意</span></a></li></ol></li></ol>
		</div>
	
	</div>
	
    <hr>
	
</div><!-- col-md-3 -->

	</div>
		

</div><!-- row -->
 
<script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=2131170"></script>



	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
  &copy; 2017 shallwe
  
      with help from <a href="http://hexo.io/" target="_blank">Hexo</a> and <a href="http://getbootstrap.com/" target="_blank">Twitter Bootstrap</a>. Theme by <a href="http://github.com/wzpan/hexo-theme-freemind/">Freemind</a>.    
</p> </footer>
</div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>▲</span> 
</a>

<script type="text/javascript" color="0,0,0" opacity='1.0' zIndex="-2" count="200" src="/js/src/particle.js"></script>  
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



   <script type="text/javascript">      
     var search_path = "search.xml";
	 if (search_path.length == 0) {
	 	search_path = "search.xml";
	 }
	 var path = "/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
   </script>

</body>
   </html>
